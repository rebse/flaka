<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.3" />
<title>The Flaka Manual</title>
<style type="text/css">
/* Sans-serif font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
div#toctitle,
span#author, span#revnumber, span#revdate, span#revremark,
div#footer {
  font-family: Arial,Helvetica,sans-serif;
}

/* Serif font. */
div.sectionbody {
  font-family: Georgia,"Times New Roman",Times,serif;
}

/* Monospace font. */
tt {
  font-size: inherit;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  font-size: inherit;
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revnumber, span#revdate, span#revremark {
}

div#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #777777;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  div#footer-badges { display: none; }
}

div#toc {
  margin-bottom: 2.5em;
}

div#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

</style>
<script type="text/javascript">
/*<![CDATA[*/
window.onload = function(){asciidoc.footnotes();}
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  var cont = document.getElementById("content");
  var noteholder = document.getElementById("footnotes");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      // Use [\s\S] in place of . so multi-line matches work.
      // Because JavaScript has no s (dotall) regex flag.
      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      spans[i].innerHTML =
        "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
        "' title='View footnote' class='footnote'>" + n + "</a>]";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
}

}
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>The Flaka Manual</h1>
<span id="author">author wh@haefelinger.it</span><br />
<span id="revnumber">version 1.1,</span>
<span id="revdate">October 2010</span>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>Writing a project's build script is serious business. And so it is when using Ant. Ant does not provide you with any abstraction how the project needs to be build. There is no underlying logic. In fact all what Ant provides are a lot of small work units, calls tasks, that need to be glued together to implement the desired logic. Ant is therefore quite similar to writing a Shell script where you can utilize all those fine masterpieces like <tt>cp</tt>, <tt>mkdir</tt> and <tt>find</tt>. However, Ant lacks any decent control structures. There is no <tt>if-then-else</tt> and there is no <tt>while</tt> <span class="footnote"><br />[<tt>if</tt> and <tt>while</tt> can be implemented in terms of calling targets depending on whether a property exists or not. Rather awkward ..]<br /></span>. What's more, you have to use a rather unfriendly, sometimes even hostile XML syntax. On the bright side however, consider this Ant snippet:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;copy todir="${destdir}"&gt;
 &lt;fileset dir="${srcdir}"&gt;
   &lt;include name="*.jar" /&gt;
 &lt;/fileset&gt;
&lt;/copy&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>It's its expressiveness which makes me list this example on the bright side as it is easy to grasp what will happen: files ending in <tt>.jar</tt> are copied from one folder into another folder. Now assume that you have to include some further logic in that snippet above:</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>if a certain folder exists, copy files matching <tt>*.zip</tt>, otherwise stick with <tt>*.jar</tt>.</em>
</p>
</li>
</ul></div>
<div class="paragraph"><p>When staying with Ant, you define a property and use it like</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;include name="${jar_or_zip}"/&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The problem is that you have to define that property elsewhere thus you start to miss part of the logic. This is where I believe that Ant has a true deficit and this is where Flaka kicks in. Flaka provides, amongst other things, with an expression language (EL). Thus you could write</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;include name=" *.#{ mydir.exists ? 'zip' : 'jar'} " /&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>However, even having such a powerful extension like EL I am missing the full power of a programming language's control structures. Yes, I want to have conditionals, repetitive constructs and a decent exception handling. Furthermore, I want to have variables which I can set or remove for pleasure. I don't want to be restricted that such variables may carry strings only. Any data object must be allowed. In summary, this is what Flaka currently is all about:</p></div>
<div class="ulist"><ul>
<li>
<p>
Expression Language
</p>
</li>
<li>
<p>
Well known control structures
</p>
</li>
</ul></div>
<div class="paragraph"><p>This pillars are Flakas approach to simplify the process of writing a build script with Ant. You are by no means forced to use all or any of those pillars. You can for example just use the control structure tasks with or without making use of EL or vice versa.</p></div>
<div class="sect2">
<h3 id="_where_to_go_from_here">1.1. Where to go from here?</h3>
<div class="ulist"><ul>
<li>
<p>
Download <span class="footnote"><br />[See <a href="http://code.google.com/p/flaka/downloads/list">http://code.google.com/p/flaka/downloads/list</a>]<br /></span> Flaka and read the <a href="#installation">installation page</a>.
</p>
</li>
<li>
<p>
Make sure to consult chapter <a href="#el">EL</a>. It contains a lot of information on this enormous useful extension.
</p>
</li>
<li>
<p>
Have a closer look in the reference part of this manual for all the gory details.
</p>
</li>
<li>
<p>
Start writing build scripts using Flaka and give feedback <span class="footnote"><br />[<a href="mailto:flaka@haefelinger.it">flaka@haefelinger.it</a>]<br /></span>.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_conventions">1.2. Conventions</h3>
<div class="paragraph"><p>Ant build file examples show a mix of tasks provided by Flaka and by Ant. Ant task do not require a namespace while those provided by Flaka do. Flaka's namespace is</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>antlib:it.haefelinger.flaka</tt></pre>
</div></div>
<div class="paragraph"><p>and within this manual, the abbreviation <tt>c</tt> will be used for this namespace. Therefore it becomes easy to see who is the provider of a task:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt; Ant &lt;/echo&gt;
&lt;c:echo&gt; Flaka &lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Thus all build file snippets shown assume that the build file contains the following XML namespace declaration:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;project xmlns:c="antlib:it.haefelinger.flaka" ..&gt;
  &lt;!-- build script example --&gt;
&lt;/project&gt;</tt></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part1">2. Installation</h2>
<div class="sectionbody">
<div class="paragraph" id="installation"><p>Download <span class="footnote"><br />[see either <a href="http://download.haefelinger.it/flaka">http://download.haefelinger.it/flaka</a> or use <a href="http://code.google.com/p/flaka/downloads">http://code.google.com/p/flaka/downloads</a>]<br /></span> latest version of Flaka and <em>drop</em> <tt>ant-flaka.x.y.z.jar</tt> into your local Ant installation. All that needs to be done is to put this jar into Java's classpath when running Ant. There are various techniques how to do so. Please read-on what exactly needs to be done.</p></div>
<div class="sect2">
<h3 id="_ready">2.1. Ready, ..</h3>
<div class="paragraph"><p>The following <strong>requirements</strong> must be satisfied before you start:</p></div>
<div class="ulist"><ul>
<li>
<p>
Flaka requires Java 1.5 or newer <span class="footnote"><br />[<a href="http://java.sun.com/javase/downloads">http://java.sun.com/javase/downloads</a>]<br /></span> or newer. You can change the version by setting environment variable <tt>JAVA_HOME</tt>. Have also a look at Ant's manual <span class="footnote"><br />[<a href="http://ant.apache.org/manual">http://ant.apache.org/manual</a>]<br /></span> for other environment variables to utilize.
</p>
</li>
<li>
<p>
Ant, version 1.7.0 or newer <span class="footnote"><br />[<a href="http://ant.apache.org">http://ant.apache.org</a>]<br /></span>.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_charge">2.2. Charge, ..</h3>
<div class="paragraph"><p>The most primitive technique is to save <tt>ant-flaka-x.y.z.jar</tt> into Ant's library folder <tt>lib</tt>. If you have no clue where Ant is installed, try</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> $ ant -diagnostics | grep ant.home
 ant.home: /opt/ant/1.7.1</tt></pre>
</div></div>
<div class="paragraph"><p>Saving something in Ant's library folder may not work if you lack required permissions. There is also the disadvantage that when switching to another installation of Ant, you need to reinstall Flaka again. Therefore consider to use option <tt>-lib</tt>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> $ ant -lib ant-flaka-x.y.z.jar</tt></pre>
</div></div>
<div class="paragraph"><p>A pretty nice feature of option <tt>-lib</tt> is, that if the argument is a folder, that folder is scanned for <tt>jar</tt> files. Therefore you may want to do something like this:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> $ mkdir $HOME/lib/ant
 $ cp ant-flaka-x.y.z.jar $HOME/lib/ant
 $ ant -lib $HOME/lib/ant</tt></pre>
</div></div>
<div class="paragraph"><p>This approach has the nice advantage that you simply can drop other jar files into folder <tt>$HOME/lib/ant</tt> to make them reachable  without touching the original Ant installation. As already mentioned, this will get handy when you have multiple Ant installations. Notice that option <tt>-lib</tt> can be applied more than once if your jars reside in various folders. Finally notice, that folders are <em>not</em> recursively scanned.</p></div>
<div class="paragraph"><p>When working from the command line, it is rather annoying to provide option <tt>-lib</tt> for each and every call. Fortunately, Ant recognizes environment variable <tt>ANT_ARGS</tt> which can be used to let <tt>-lib</tt> disappear:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> $ ANT_ARGS="-lib $HOME/lib/ant"
 $ export ANT_ARGS</tt></pre>
</div></div>
<div class="paragraph"><p>The drawback with this technique is that you need to make sure that this variable is set in every environment you start up Ant. This sounds perhaps easier than actually done. Luckily again, Ant reads file <tt>$HOME/.antrc</tt> and <tt>$HOME/.ant/ant.conf</tt> on each and every start-up. It is therefore recommended to set variable <tt>ANT_ARGS</tt> in one of this files <span class="footnote"><br />[when doing so, you don&#8217;t need to <em>export</em> that variable]<br /></span>to make just every plain call to <tt>ant</tt> is aware of Flaka. For example:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> $ cat $HOME/.antrc
 ANT_ARGS="-lib $HOME/lib/ant"</tt></pre>
</div></div>
<div class="paragraph"><p>Finally it should be mentioned, that Ant scans for additional jars in folder <tt>$HOME/.ant/lib</tt>. Thus the following two invocations of Ant are identical</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> $ ant
 $ ant -lib $HOME/.ant/lib</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_fire">2.3. Fire!</h3>
<div class="paragraph"><p>To check whether your setup is proper, create a small build script and try to execute it. For example,try this</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ cat &gt; build.xml &lt;&lt; EOF
&lt;project xmlns:c="antlib:it.haefelinger.flaka"&gt;
 &lt;c:logo&gt;
  Hello, #{property['ant.file'].tofile.name}
 &lt;/c:logo&gt;
&lt;/project&gt;
^D</tt></pre>
</div></div>
<div class="paragraph"><p>Then, when created, try to execute it with your Flaka equipped Ant. You should
see something like</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ ant
:::::::::::::::::::::::::::::::::::::::::::::::::::
::               Hello, build.xml                ::
:::::::::::::::::::::::::::::::::::::::::::::::::::
BUILD SUCCESSFUL
[..]</tt></pre>
</div></div>
<div class="paragraph"><p>if everything is well setup.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="el">3. EL</h2>
<div class="sectionbody">
<div class="paragraph"><p>The <em>Unified Expression Language</em> <span class="footnote"><br />[<a href="http://en.wikipedia.org/wiki/Unified_Expression_Language">http://en.wikipedia.org/wiki/Unified_Expression_Language</a>]<br /></span>, further in this document abbreviated as <em>EL</em>, is a special purpose programming language typically used for embedding expressions in web applications. While EL is part of the JSP Specification, it does not depend on JSP and can therefore be used in a variety of other contexts. One such context is Ant. Consider the following example <span class="footnote"><br />[To make this example work, one need to globally enable EL for all string contexts. By default, EL is <em>not</em> globally enabled. To enable it globally, use Flaka's task <tt>&lt;c:install-property-handler/&gt;</tt>]<br /></span>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
  Modified #{ format('%tD', file(project).mtime) }
&lt;echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The EL expression here, a function call with two arguments, utilizes two standard of Flaka's standard functions, namely <tt>format()</tt> for creating a string and <tt>file()</tt> for turning something into a file object. Function <tt>format()</tt> accepts an arbitrary number of arguments. Two arguments are provided in this example. A string argument as the first argument while the second argument is the object returned by querying property <tt>mtime</tt> on the file object returned <tt>file(project)</tt>.  Argument <tt>project</tt> is one of Flaka's implicit objects. In particular, <tt>project</tt> represents the current Ant project. The evaluation of <tt>file(project)</tt> is the project's base directory as file object. Such a file object has various properties. One property is the file's last modification time available as property <tt>mtime</tt>. The whole EL expression is embedded in the textual context of Ant's standard <tt>echo</tt> task.  The embedment is done using <tt>#{</tt> and <tt>}</tt> respectively. When executed, this snippet produces something like</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>[echo] Modified 10/29/10</tt></pre>
</div></div>
<div class="paragraph"><p>Here are some further examples of EL expressions:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>7 * (5.0+x) &gt;= 0             ; (1)
a and not (b || false)       ; (2)
empty L ? null : L[0]        ; (3)
list('a','b')                ; (4)
split('a,b',',')             ; (5)
project.name                 ; (6)
size(file('.').list)         ; (7)</tt></pre>
</div></div>
<div class="paragraph"><p>The first expression (1) shows a algebraic equation. Notice the usage of <tt>5.0</tt> being of type float, <tt>7</tt> being an integral type and furthermore <tt>x</tt> as variable. A Boolean expression is shown in the second example using operators <tt>and</tt>, <tt>not</tt> and operator <tt>||</tt>. The same expression could also have been written like <tt>a &amp;&amp; !(b or false)</tt>. Example (3) shows operator <tt>empty</tt> and conditional operator <tt>?:</tt>. The expression could be read like: check whether a (list) object is empty. If empty, return <tt>null</tt>, otherwise return the list's first item. The fourth and fifth expression shows two list generating functions - <tt>list()</tt> just collects all arguments into a list while <tt>split()</tt> breaks a string apart based on a regular expression. The project's name is queried in example (6) while example (7), calculates the number of files and folders in the current working directory.</p></div>
<div class="sect2">
<h3 id="el_enabling_el">3.1. EL References</h3>
<div class="paragraph"><p>It turned out that it is a good idea to have a clear distinction between properties and EL expressions. Therefore, an EL expression must be enclosed by <tt>#{..}</tt> rather than by <tt>${..}</tt>. A enclosed EL expression is called an reference to a EL expression. Similarly is <tt>${..}</tt> named a reference to a Ant property. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
 ${3 * 4}   ; Property reference
 #{3 * 4}   ; EL expression reference
&lt;/echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Ant is by default not aware of EL. Thus the EL reference <tt>#{3 * 4}</tt> would not be evaluated and would be passed as is. To let Ant evaluate EL expression references, EL must be enabled <span class="footnote"><br />[see task <a href="#task_install_property_handler"><tt>install-property-handler</tt></a> for how to do this]<br /></span>. Once enabled, EL references can be used wherever Ant property references can be used. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
 #{3 * 4}   ; still #{3 * 4}
&lt;/echo&gt;
&lt;c:install-property-handler /&gt;
&lt;property name="twelve" value="#{ 3 * 4 }" /&gt;
&lt;echo&gt;
 #{3 * 4}   ; 12
 ${twelve}  ; 12
&lt;/echo&gt;</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_enabling">3.1.1. Enabling</h4>
<div class="paragraph"><p>To enable EL references in addition to Ant property references, Ant's standard property helper engine must be exchanged. This is best done using Flaka's  <a href="#task_install_property_handler"><tt>install-property-handler</tt></a> task. This task can be used everywhere. It is however recommended to (a) call it only once (b) to call it as early as possible.</p></div>
<div class="paragraph"><p>Starting with version 1.8 Ant provides a task for switching property helpers. This task can also be used to change the characteristics how Ant property references are handled. To support this new property API, Flaka provides a second Antlib in addition to the standard one. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;project xmlns:prop="antlib:it.haefelinger.flaka.prop"&gt;
 &lt;propertyhelper&gt;
    &lt;prop:elreferences /&gt;
 &lt;/propertyhelper&gt;
 &lt;echo&gt;
   #{ 3 * 4 }   ; 12
 &lt;/echo&gt;
&lt;/project&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>For those who want to stay more in-line with Ant property references, Flaka ships with a property evaluator. When this evaluator is plugged in, <tt>${..}</tt> will be evaluated as EL reference. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;project xmlns:prop="antlib:it.haefelinger.flaka.prop"&gt;
 &lt;propertyhelper&gt;
    &lt;prop:elevaluator /&gt;
 &lt;/propertyhelper&gt;
 &lt;echo&gt;
   ${ 3 * 4 }   ; 12
 &lt;/echo&gt;
&lt;/project&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_conversion">3.1.2. Conversion</h4>
<div class="paragraph"><p>Ant properties are strings, thus Ant properties are used in string contexts and consequently the same applies for EL references. When an EL reference is seen, the EL expression is firstly evaluated into an object of some type <em>T</em>. Then, in a second step, that object value is coerced <span class="footnote"><br />[implicitly type converted]<br /></span> into a string value.</p></div>
</div>
<div class="sect3">
<h4 id="_nested_references">3.1.3. Nested References</h4>
<div class="paragraph"><p>Nested references are <em>not</em> supported. The following example, which tries to do some sort of meta-programming on implicit object <tt>project</tt>, is therefore illegal</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo&gt;
     #{ project.#{ property } }   ; illegal
&lt;/c:echo&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_nested_properties">3.1.4. Nested Properties</h4>
<div class="paragraph"><p>Ant property references <tt>${..}</tt> are resolved before any EL reference is resolved. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;property name="pname" value="basedir" /&gt;
&lt;c:echo&gt;
     #{ project.${pname} }        ; project.basedir
     ${ project.#{ 'basedir' }}   ; no way
&lt;/c:echo&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_the_great_escape">3.1.5. The Great Escape</h4>
<div class="paragraph"><p>How about getting a character sequence like <tt>#{ 3 * 4}</tt>?. In other words, how to prevent a EL reference from being evaluated? There are basically two techniques available. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
 #{ '#{3 * 4}' }        ;    #{ 3 * 4 }
     \#{ 3 * 4 }        ;    #{ 3 * 4 }
&lt;/echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The first line shows the recommended technique, i.e. embed the character sequence <tt>#{</tt> in a EL string. The second line demonstrates the usage of <tt>\#{</tt> as escape sequence. Using this escape sequence is counter intuitive. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
     #{ 3 * 4 }        ;    12
    \#{ 3 * 4 }        ;    #{ 3 * 4 }
   \\#{ 3 * 4 }        ;   \#{ 3 * 4 }
  \\\#{ 3 * 4 }        ;  \\#{ 3 * 4 }
 \\\\#{ 3 * 4 }        ; \\\#{ 3 * 4 }
&lt;/echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>In other words, when character sequence <tt>\#{</tt> is seen, then character <tt>\</tt> is consumed and <tt>#{</tt> does not start an EL reference, i.e. the sequence is taken literally.  It has to be noted, that character <tt>\</tt> alone does not have any meaning and is especially not a general escape character. Thus any number of contiguous backslash characters before an EL reference successfully disables its evaluation.</p></div>
<div class="paragraph"><p>Given this behaviour, how is it then possible to create backslash characters before an evaluated EL reference? As an example, assume that we have a EL variable named <tt>host</tt> and our task is to generate a UNC <span class="footnote"><br />[Uniform Naming Convention, see also <a href="http://en.wikipedia.org/wiki/Path_(computing)#Uniform_Naming_Convention">http://en.wikipedia.org/wiki/Path_(computing)#Uniform_Naming_Convention</a>]<br /></span> notation. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
 \\#{ host }                   ;    \#{ host }
 #{ format('\\\\%s',host) }    ;    \\myhostname
&lt;/echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Please notice that escaping a property reference is different than escaping a EL reference. A property reference is taken literally if prefixed by character <tt>$</tt>. In addition, <em>every</em> double dollar sequence <tt>$$</tt> is reduced into a single dollar character. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
   ${foo}          ; bar
  $${foo}          ; ${foo}
 $$${foo}          ; $bar
$$$${foo}          ; $${foo}
 foo $ bar         ; foo $ bar
foo $$ bar         ; foo $ bar
&lt;/echo&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_whitespace">3.1.6. Whitespace</h4>
<div class="paragraph"><p>Trailing and leading whitespace is meaningless within EL references. This is different from Ant properties where whitespace is meaning full. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;property name=" p " value="weired name ' p '" /&gt;
&lt;property name="p" value="regular name 'p'" /&gt;
&lt;c:echo&gt;
     ${p}                 ; regular name 'p'
     ${ p }               ; weired name ' p '
     #{ p }               ; regular name 'p'
     #{ property[' p '] } ; weired name ' p '
&lt;/c:echo&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_syntax_errors">3.1.7. Syntax Errors</h4>
<div class="paragraph"><p>A syntax error in a EL expression will be silently ignored. Furthermore, the EL engine will tries to recover by ignoring all characters until either character <tt>}</tt> or <tt>&lt;eof&gt;</tt>, the end of input, is seen. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>0#{ 3 * 3    ; 0
0#{ 3 * }3   ; 03
0#{ 3 * 4 }3 ; 0123</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_el_awareness">3.1.8. EL Awareness</h4>
<div class="paragraph"><p>Flaka is naturally EL aware. Regardless of whether EL has been enabled or not, all Flaka tasks understand EL references <tt>#{..}</tt> without any additional action.</p></div>
<div class="paragraph"><p>In addition, attributes of tasks provided by Flaka can be <em>typed</em>. A argument provided to a <em>typed</em> attribute is expected to be an EL expression. Evaluating that expression will be done in the context of an expected <em>type</em>. Consider attribute <tt>test</tt> of Flaka's <a href="#task_when"><tt>when</tt></a> task:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:when test=" file(path).isdir "&gt;
  &lt;!-- do something with that dir folder .. --&gt;
&lt;/c:when&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Attribute <tt>test</tt> is typed and it's expected type is <tt>boolean</tt>. The argument must be a an EL expression, here <tt>file(path).isdir</tt>. That EL expression will be evaluated into some object and then, in a second step coerced into a boolean value.</p></div>
<div class="paragraph"><p>Notice that Ant and EL references can be used in typed attributes. After all, a typed attribute is a regular attribute as far as Ant is concerned. It is just Flaka who is evaluating the expression as EL. Thus consider this kind of meta-programming , that all attributes are handled by the currently installed property handler. Thus even for attribute <tt>test</tt> the normal attribute rules apply. Consider this kind of meta-programming where by default an object is queried for property <tt>isdir</tt> subject to whether variable <tt>prop</tt> is empty or not. If not empty, then the value is queried for property <tt>prop</tt>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:when test=" obj.#{ empty prop ? 'isdir' : prop} "&gt;
 ..
&lt;/c:when&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The following sections will handle some advanced issues regarding EL references and especially their relation with Ant property references.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="el_data_types">3.2. Data Types</h3>
<div class="paragraph"><p>The following types can be used when writing EL expressions:</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>null</em> to represent the absence of any data
</p>
</li>
<li>
<p>
<em>integer</em> for integer values
</p>
</li>
<li>
<p>
<em>float</em> for any floating point values
</p>
</li>
<li>
<p>
<em>boolean</em> to express Boolean logic
</p>
</li>
<li>
<p>
<em>string</em> to represent char sequences
</p>
</li>
<li>
<p>
<em>list</em> for iterable types
</p>
</li>
<li>
<p>
<em>map</em> for dictionary like types
</p>
</li>
<li>
<p>
<em>file</em> representing file objects
</p>
</li>
<li>
<p>
<em>project</em> representing Ant project instances
</p>
</li>
<li>
<p>
<em>object</em> for all other data values
</p>
</li>
</ul></div>
<div class="paragraph"><p>The question is how to get a element of those? EL defines literals denoting elements of type <tt>null</tt>, <tt>integer</tt>, <tt>float</tt>, <tt>boolean</tt>, and <tt>string</tt>. Furthermore there are implicit objects and functions, see below.</p></div>
<div class="sect3">
<h4 id="_null_literals">3.2.1. Null Literals</h4>
<div class="paragraph"><p>The <tt>null</tt> type contains only one data element also called <tt>null</tt>. From a semantic point of view it is used to represent the absence of any data. Within EL, <tt>null</tt> has an interesting characteristic: it can be asked whether it has a certain property and the answer will always be <tt>null</tt> again. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>null['any property']   ; null
null.mtime             ; null</tt></pre>
</div></div>
<div class="paragraph"><p>This rather different from other languages where asking <tt>null</tt> for a property is asking for trouble, i.e. null pointer exception and the like. Notice also the following differences between operator <tt>empty</tt> and function <tt>nullp()</tt> when working with value <tt>null</tt>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>empty null     ; true
empty list()   ; true
empty ''       ; true
nullp(null)    ; true
nullp(list())  ; false
nullp('')      ; false</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_string_literals">3.2.2. String Literals</h4>
<div class="paragraph"><p>A string literal starts and ends with the same quotation character. Quotation characters are either the single quote <tt>'</tt> or the double quote <tt>"</tt> character. If the quotation character is needed within the literal, then the escape character <tt>\</tt> must be used. The escape character must also be used if the escape character itself is to be expressed in the literal. The escape character can't be used to escape other characters than the quotation character and the escape character.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>"abc"        ; abc
'abc'        ; abc
'abc"        ; illegal
"a'c"        ; a'c
'a"c'        ; a"c
'a\'c'       ; a'c
'a\"c'       ; a\"c
"a\"c"       ; a"c
'a\bc'       ; a\bc
'a\\bc'      ; a\bc
'ab\'        ; illegal
'ab\\'       ; ab\</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_object_literals">3.2.3. Object  Literals</h4>
<div class="paragraph"><p>Well, EL has no notation for <em>object</em> literals like literals for type integer and boolean. So, how to get an object in the first place? There are two possibilities:</p></div>
<div class="ulist"><ul>
<li>
<p>
use an implicit object; and
</p>
</li>
<li>
<p>
use a function
</p>
</li>
</ul></div>
<div class="paragraph"><p>Once you have an object, you can in addition
* use an object's property
to retrieve another object. When does a property exist and how to retrieve it? This and other questions are answered in section <a href="#el_properties">[el_properties]</a> while section <a href="#el_implicit_objects">[el_implicit_objects]</a> lists available implicit objects and section <a href="#el_functions">[el_functions]</a> is about functions to be used.</p></div>
<div class="paragraph"><p>Notice that EL does also not provide a notation for arrays or list objects nor is there a <tt>list</tt> data type. Nevertheless, Flaka provides a <tt>list()</tt> function to create a collection of arbitrary objects. There is also task <tt>for</tt> able to iterate over collection types and there is function <tt>size()</tt> which returns the number of items in a collection. How does this work? EL uses a concept called <em>duck typing</em> where a object's type is not given by a class but rather by it's properties: <em>I call every object that walks, swims and quacks like a duck, a duck</em>. Thus properties are looked up during runtime and a object provides all required properties, the object is applied.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="el_variables">3.3. Variables</h3>
<div class="paragraph"><p>The EL language does not allow you to create variables and must thus be created by other means <span class="footnote"><br />[See task <a href="#task_let">[task_let]</a> for creating EL variables, properties and overriding properties]<br /></span>. Nevertheless, variables can be used within expressions. When a <em>name</em> is evaluated, then <em>name</em> is looked up</p></div>
<div class="ulist"><ul>
<li>
<p>
as implicit object; or
</p>
</li>
<li>
<p>
as entry in EL's variable dictionary; or
</p>
</li>
<li>
<p>
as Ant property name
</p>
</li>
</ul></div>
<div class="paragraph"><p>in this particular order, consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;property name="p" value="property" /&gt;
&lt;property name="q" value="property" /&gt;
&lt;c:let&gt;
 q = 'variable'
&lt;/c:let&gt;
&lt;echo&gt;
 ${p}           ; 'property'
 #{p}           ; 'property'
 ${q}           ; 'property'
 #{q}           ; 'variable'
 #{property.q } ; 'property'
&lt;/echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>If no entry can be associated with <em>name</em>, then <tt>null</tt> will be the look-up's result. This has the interesting consequence, that EL references are <em>always</em> disappearing, i.e. can always be resolved. Whereas unknown properties remain as  property references. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;
 ${not_a_name}  ; ${not_a_name}
 #{not_a_name}  ; ''
&lt;/echo&gt;</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="el_operators">3.4. Operators</h3>
<div class="paragraph"><p>The following operators are defined in <a href="#el">EL</a>:</p></div>
<div class="ulist"><ul>
<li>
<p>
operator <tt>empty</tt> checks whether a variable is empty or not and returns either <tt>true</tt> or <tt>false</tt>. It is important to understand that <tt>null</tt> is considered empty.
</p>
</li>
<li>
<p>
condition operator <tt>?:</tt> can be used for branching in expressions. The expression <tt>cond ? a : b</tt> evaluates expression <tt>cond</tt> in a Boolean context. If <tt>eval(cond)</tt> returns <tt>true</tt> then the result of the expression is <tt>eval(a)</tt> and otherwise <tt>eval(b)</tt>.
</p>
</li>
<li>
<p>
operators <tt>.</tt> and  <tt>[]</tt> are used to query properties on objects. See also section <a href="#el_properties">Properties_</a>.
</p>
</li>
<li>
<p>
logical operators <tt>not</tt>, <tt>and</tt> and <tt>or</tt>
</p>
</li>
<li>
<p>
relational operators <tt>==</tt>, '!=<tt>, `&lt;</tt>, <tt>&gt;</tt>, <tt>&lt;=</tt> and <tt>&gt;=</tt> (resp. <tt>eq</tt>, <tt>ne</tt>, <tt>lt</tt>, <tt>gt</tt>, <tt>le</tt> and <tt>ge</tt>).
</p>
</li>
<li>
<p>
usual arithmetic operators like <tt>+</tt>, <tt>-</tt>, <tt>*</tt>, <tt>/</tt>, <tt>mod</tt> and <tt>div</tt> etc.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="el_implicit_objects">3.5. Implicit Objects</h3>
<div class="paragraph"><p>Flaka provides implicit objects that can be utilized writing <a href="#el">[el]</a> expressions:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top"> Implicit Object </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table">pi</p></td>
<td align="left" valign="top"><p class="table">The number <a href="http://en.wikipedia.org/wiki/PI">PI</a></p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">project</p></td>
<td align="left" valign="top"><p class="table">The current Ant project as object. To query the project's default target, base folder and other things (see also <a href="#el_project_properties">project properties</a> and <a href="#el_natural_properties">natural properties</a>).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">property</p></td>
<td align="left" valign="top"><p class="table">Use this object to query project properties.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">e</p></td>
<td align="left" valign="top"><p class="table">The mathematical number <a href="http://en.wikipedia.org/wiki/E_(mathematical_constant)">e</a>, also known as <a href="http://en.wikipedia.org/wiki/Euler">Euler</a>'s number.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The following implicit objects are deprecated:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top"> Implicit Object </th>
<th align="left" valign="top"> Alternative</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table">filter</p></td>
<td align="left" valign="top"><p class="table"><tt>project.filters</tt></p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">reference</p></td>
<td align="left" valign="top"><p class="table"><tt>project.references</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">var</p></td>
<td align="left" valign="top"><p class="table"><tt>project.references</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">target</p></td>
<td align="left" valign="top"><p class="table"><tt>project.targets</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">taskdef</p></td>
<td align="left" valign="top"><p class="table"><tt>project.taskdefs</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">macrodefs</p></td>
<td align="left" valign="top"><p class="table"><tt>project.macrodefs</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">tasks</p></td>
<td align="left" valign="top"><p class="table"><tt>project.tasks</tt></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="el_functions">3.6. Functions</h3>
<div class="paragraph"><p>This sections presents functions defined by Flaka and which are available without any further action. Notice that providing own functions is currently not possible. A note about the conventions used in the notation of function signatures:</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>T</em> is a placeholder meaning any type
</p>
</li>
<li>
<p>
<em>T..</em> means that a variable list of arguments of type <em>T</em> can be used
</p>
</li>
<li>
<p>
<em>name:T</em> is used to give a parameter a name which is then used in the follow up explanation of this function.
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="_generic_functions">3.6.1. Generic Functions</h4>
<div class="sect4">
<h5 id="_tt_typeof_t_string_tt"><tt>typeof(T):string</tt></h5>
<div class="paragraph"><p>A function to determine the object's type:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>typeof(null)               ; 'null'
typeof('')                 ; 'string'
typeof(3)                  ; 'integer'
typeof(pi)                 ; 'float'
typeof(true)               ; 'boolean'
typeof(list())             ; 'list'
typeof(file('.'))          ; 'file'
typeof(project)            ; 'project'
typeof(project.properties) ; 'map'
typeof(other)              ; 'object'</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_nativetype_t_string_tt"><tt>nativetype(T):string</tt></h5>
<div class="paragraph"><p>Use this function to determine native type, the type of the underlying implementation, of the given argument.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>nativetype(null)                ; ''
nativetype('')                  ; 'java.lang.String'
nativetype(3)                   ; 'java.lang.Long'
nativetype(pi)                  ; 'java.lang.Double'
nativetype(true)                ; 'java.lang.Boolean'
nativetype(list())              ; 'java.util.ArrayList'
nativetype(file(project))       ; 'java.io.File'
nativetype(project)             ; 'org.apache.ant.tools.Project'
nativetype(project.properties)  ; 'java.util.Hashtable'
nativetype(file(project).mtime) ; 'java.util.Date'</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_size_t_integer_tt"><tt>size(T):integer</tt></h5>
<div class="paragraph"><p>The size of the object is given by the number of entities it contains. This is 0 (zero) for all primitive types like <tt>integer</tt>, <tt>null</tt>, <tt>float</tt>, <tt>boolean</tt>. Otherwise the object's size is determined via a <tt>size</tt> or <tt>length</tt> property.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>size(null)            ; 0
size(3)               ; 0
size(pi)              ; 0
size(true)            ; 0
size('abc')           ; 3
size(list(1,2))       ; 2
size(file(..))        ; see below
size(project)         ; 0
size(object)          ; object.size or object.length or 0</tt></pre>
</div></div>
<div class="paragraph"><p>If the argument of <tt>size()</tt> is of type <em>file</em> and the argument denotes an existing and accessible directory <em>d</em>, then <tt>size(d)</tt> returns the amount of files and folders in <em>d</em>. Otherwise, if the argument denotes an existing and accessible file, then the length of that file is returned. Otherwise, size() will return 0.</p></div>
</div>
<div class="sect4">
<h5 id="_tt_nullp_t_boolean_tt"><tt>nullp(T):boolean</tt></h5>
<div class="paragraph"><p>Evaluates to <tt>true</tt> if object is the <tt>null</tt> entity and <tt>false</tt> otherwise. Compare this function with operator <tt>empty</tt> which returns <tt>true</tt> if either the object in question does not exist or if literally empty, for example the empty list or the empty string.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>nullp(null)            ; true
nullp(list())          ; false
nullp('')              ; false
empty null             ; true
empty list()           ; true
empty ''               ; true</tt></pre>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_file_and_folder_functions">3.6.2. File and Folder Functions</h4>
<div class="sect4">
<h5 id="_tt_file_t_file_tt"><tt>file(T..):file</tt></h5>
<div class="paragraph"><p>A function to create a <tt>file</tt> object. If <tt>file()</tt> is called without argument, then the current working directory is returned. Otherwise, if the function is called with one argument and that argument is already a file, the argument is simply returned. Otherwise, if the argument's type is <tt>project</tt>, then the base directory of that Ant project is returned. If the argument is a <tt>list</tt> type, the a file is constructed based on the list's elements. Otherwise the argument stringized. If the stringized argument consists only of whitespace, then the current working directory is returned while otherwise that string is taken as the file's path name. If <tt>file()</tt> is called with two or more arguments, then the behaviour is the same as if <tt>file()</tt> would have been called with one list argument where the list consists of the function's arguments.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>file()               ; your JVM current work directory
file('.')            ; file()
file(file(arg))      ; file(arg)
file(project)        ; project.basedir
file(list('/',a))    ; file('/',file(a))
file(other)          ; file(format('%s',other))
file(a,b,c)          ; file(list(a,b,c))
file(a,list(b,c),d)  ; file(list(a,b,c,d))</tt></pre>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_string_functions">3.6.3. String Functions</h4>
<div class="sect4">
<h5 id="_tt_concat_t_string_tt"><tt>concat(T..):string</tt></h5>
<div class="paragraph"><p>Creates a string by concatenating all <em>stringized</em> objects. If no object is provided, the empty string is returned. Thus to create the string <tt>foobar</tt>, try</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>concat('foo','bar')  ; 'foobar'</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_format_string_t_string_tt"><tt>format(string,T..):string</tt></h5>
<div class="paragraph"><p>This function is a Swiss army knife for creating a string based on existing objects. The functions expects a format string as first argument followed by any number of arguments. The optional arguments are used to construct the result string based on format instructions embedded in the first argument. Some examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>format('foobar')           ; 'foobar'
format('foo%s','bar')      ; 'foobar'
format('%s%S','foo','bar') ; 'fooBAR'
format('%s',list('a',2))   ; '[a, 2]'</tt></pre>
</div></div>
<div class="paragraph"><p>The number of format options to be used are almost infinite <span class="footnote"><br />[Compare <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html">http://download.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html</a>]<br /></span>.</p></div>
</div>
<div class="sect4">
<h5 id="_tt_replace_string_subst_t_regex_t_string_tt"><tt>replace(string, subst:T, regex:T):string</tt></h5>
<div class="paragraph"><p>Create a new string by replacing substrings. Substrings to be replaced are described via regular expressions. If no substitute string is given, the empty string is used. The default regular expression is <tt>\s*,\s*</tt> which means, that all commas - including leading and trailing whitespace - are replaced. Arguments are stringized before used.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>replace('a, b')              ; 'ab'
replace('a, b','')           ; 'ab'
replace('a, b','','\s*,\s*')  ; 'ab'
replace(true,'false','true') ; 'false'</tt></pre>
</div></div>
<div class="paragraph"><p>The behaviour of this function is undefined if called without arguments.</p></div>
</div>
<div class="sect4">
<h5 id="_tt_split_string_regex_t_list_tt"><tt>split(string, regex:T):list</tt></h5>
<div class="paragraph"><p>A function to tokenize a string into a list of strings. Tokens are separated from each other by text matching a given regular expression. Arguments are stringized before used. If no regular expression is given, then <tt>\*s,\s*</tt> is used. The behaviour is undefined if no arguments are given.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>split('a,b')          ; list('a','b')
split('a:b',':')      ; list('a','b')</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_trim_string_string_tt"><tt>trim(string):string</tt></h5>
<div class="paragraph"><p>A convenience function to remove leading and trailing whitespace from a string (stringized object). This function can be expressed in terms of function <tt>replace()</tt> like</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>trim(s)              ; replace(s,'','^\s*|\s*$')</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_ltrim_string_string_tt"><tt>ltrim(string):string</tt></h5>
<div class="paragraph"><p>Similar to function <tt>trim()</tt> above but only leading whitespace is being removed.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>ltrim(s)              ; replace(s,'','^\s*')</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_rtrim_string_string_tt"><tt>rtrim(string):string</tt></h5>
<div class="paragraph"><p>Similar to function <tt>trim()</tt> above but only trailing whitespace is being removed.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>rtrim(s)              ; replace(s,'','\s*$')</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_matches_text_object_regex_object_boolean_tt"><tt>matches(text:object:regex:object):boolean</tt></h5>
<div class="paragraph"><p>A function to match a charater sequence against a regular expression. If the regular expression matches a subsequence of text, the function returns <tt>true</tt>. If the regular expression is invalid, the function&#8217;s behaviour is undefined.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>matches('aZc','aZc')    ; true
matches('aZc','Z')      ; true (!)
matches('aZc','^Z$')    ; false
matches('aZc','^\w+')   ; true
matches('aZc,'[^ab[')   ; undef.</tt></pre>
</div></div>
<div class="paragraph"><p>Be aware that <tt>matches()</tt> works on subsequences whereas Java's String method <tt>matches()</tt> works on the entire input sequence. However, it is rather easy to let <tt>matches()</tt> return <tt>true</tt> only if the entire input sequence is covered by the regular expression: wrap the original regex using anchors:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>matches(concat('^',myregex,'$'),..)</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_glob_text_object_regex_object_boolean_tt"><tt>glob(text:object:regex:object):boolean</tt></h5>
<div class="paragraph"><p>Similar to function <tt>matches()</tt> described in the previous section: the input is matched against a glob expression. A glob expression may contain wildcard characters like <tt>*</tt> for any number of characters, <tt>?</tt> for exactly one character and <tt>[..]</tt> for a set of known characters. Furthermore wildcard characters can be escaped using character backslash <tt>\\</tt>. Function <tt>glob()</tt> always takes the whole input sequence into account, thus</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>glob('','')            ; true
glob('a','a')          ; true
glob('a','\w')         ; false, '\w' means just 'w'
glob('w','\w')         ; true
glob('abc','ab')       ; false
glob('abc','ab*')      ; true
glob('abc','ab?')      ; true
glob('abc','ab[c]')    ; true
glob('ab*','ab\*')     ; true</tt></pre>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_list_functions">3.6.4. List Functions</h4>
<div class="paragraph"><p>This sections lists EL functions operating on lists where a list is a synonym for any collection of elements. In case you are missing a function to retrieve the n-th list element, then try</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>list('a','b','c')[1]           ; 'b'</tt></pre>
</div></div>
<div class="sect4">
<h5 id="_tt_list_t_list_tt"><tt>list(T..):list</tt></h5>
<div class="paragraph"><p>A function taking a arbitrary number of elements to create a list object. Returns the empty list when called without arguments.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>list()                ; []
list('a',2)           ; ['a',2]
list(list('a',2))     ; [['a',2]]</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_append_t_list_tt"><tt>append(T..):list</tt></h5>
<div class="paragraph"><p>This function is similar to <tt>list</tt> by creating a list based on given arguments. However, each argument being a list is treated in a special way by appending the list elements rather the list itself.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>append()                       ; list()
append('a',2)                  ; list('a',2)
append(1,list('a',2),true)     ; list(1,'a',2,true)</tt></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_tt_join_string_list_string_tt"><tt>join(string,list):string</tt></h5>
<div class="paragraph"><p>This functions creates a string by joining elements in <tt>list</tt> with the first argument. The first argument is stringized. If the second argument not given, the empty string is returned. Otherwise, if the second argument is not a list, then the stringized second argument is returned. The behaviour is undefined if called without arguments.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>join(':')                    ; ''
join(':',5)                  ; '5'
join(':',list('a',2))        ; 'a:2'</tt></pre>
</div></div>
<div class="paragraph"><p>If this function is called with more then two arguments, then all arguments but the first are collected into a list object and then processed like described above.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>join(':','a',2)              ; join(':',list('a',2))</tt></pre>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_mathematical_functions">3.6.5. Mathematical Functions</h4>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="45%" />
<col width="55%" />
<thead>
<tr>
<th align="left" valign="top"> Function </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table"><tt>rand():double</tt></p></td>
<td align="left" valign="top"><p class="table">Returns a double value with a positive sign, greater than or equal to 0.0 and less than 1.0.</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>sin(double):double</tt></p></td>
<td align="left" valign="top"><p class="table">The mathematical <a href="http://en.wikipedia.org/wiki/Trigonometric_functions">sine</a> function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cos(double):double</tt></p></td>
<td align="left" valign="top"><p class="table">The mathematical <a href="http://en.wikipedia.org/wiki/Trigonometric_functions">cosine</a> function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>tan(double):double</tt></p></td>
<td align="left" valign="top"><p class="table">The mathematical <a href="http://en.wikipedia.org/wiki/Trigonometric_functions">tangent</a> function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>exp(double):double</tt></p></td>
<td align="left" valign="top"><p class="table">The mathematical exponential function, <tt>e</tt> raised to the power of the given argument</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>log(double):double</tt></p></td>
<td align="left" valign="top"><p class="table">The mathematical logarithm function of base <tt>e</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>pow(double,double):double</tt></p></td>
<td align="left" valign="top"><p class="table">Returns the value of the first argument raised to the power of the second argument.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>sqrt(double):double</tt></p></td>
<td align="left" valign="top"><p class="table">Returns the correctly rounded positive square root of a double value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>abs(double):double</tt></p></td>
<td align="left" valign="top"><p class="table">Returns the absolute value of a double value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>min(double, double):double</tt></p></td>
<td align="left" valign="top"><p class="table">Returns the smaller of two double values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>max(double, double):double</tt></p></td>
<td align="left" valign="top"><p class="table">Returns the larger of two double values.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="el_properties">3.7. Properties</h3>
<div class="paragraph"><p>It's best to introduce properties with three simple examples. It's about to ask a string about his uppercase variant, about it's length and about to create a folder with the string's value.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>'abc'.toupper           ; 'ABC'
'abc'.length            ; 3
'abc'['tofile'].mkdir   ; true/false</tt></pre>
</div></div>
<div class="paragraph"><p>The specification of EL provides only a notation to query an object for a property. EL does not specify which properties must exist nor does it require that an object must have any properties. Each implementation is free to define properties according to the underlying implementation and usage domain. What is specified however is, how to query a property. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>obj.name
obj['name.with.dot']</tt></pre>
</div></div>
<div class="paragraph"><p>The first variation is the standard notation to look-up property <tt>name</tt> on object <tt>obj</tt>. Here <tt>name</tt> can be composed of almost any character but character <tt>.</tt> itself. After all, <tt>.</tt> is the look-up operator here. This limitation can cause problems in certain domains. Therefore, an alternative look-up operator <tt>[]</tt> has been defined by the specification.</p></div>
<div class="paragraph"><p>Another important point to keep in mind is about looking up a property on the <tt>null</tt> object and what is the result of asking for a property which does not exist? The perhaps surprising answer is that both case do not cause an error or worse but are perfectly legal and well defined. The result is in both cases the <tt>null</tt> object. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>null.someproperty        ; null
obj.notexisting          ; null</tt></pre>
</div></div>
<div class="paragraph"><p>Now it's about time to tell, which properties are available.</p></div>
<div class="sect3">
<h4 id="el_natural_properties">3.7.1. Natural Properties</h4>
<div class="paragraph"><p>A <em>natural</em> property <tt>x</tt> exits if the underlying Java object has a public getter method with the same name as <tt>x</tt> and where the names are compared case-insensitively. Assume that we have on object <tt>f</tt> of type <tt>java.io.File</tt> <span class="footnote"><br />[see <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/io/File.html">http://download.oracle.com/javase/1.5.0/docs/api/java/io/File.html</a>]<br /></span>. The following listing shows two natural properties on object <tt>f</tt> and how <tt>f</tt> will be used by the underlying EL implementation:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>f.name              ; f.getName()
f['parentfile']     ; f.getParentFile()</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_primitive_type_properties">3.7.2. Primitive Type Properties</h4>
<div class="paragraph"><p>Primitive data types (integer, float, boolean and null) have no properties.</p></div>
</div>
<div class="sect3">
<h4 id="_list_and_array_properties">3.7.3. List and Array Properties</h4>
<div class="paragraph"><p>Besides <em>natural</em> properties can lists and arrays be queried with an <em>index</em> returning the element at that position or <tt>null</tt> if the index is out of range. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>list('a','b')[1]    ; 'b'
list('a','b')[-1]   ; null
list('a','b')[2]    ; null</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="el_string_properties">3.7.4. String Properties</h4>
<div class="paragraph"><p>Table above lists properties that can be queried besides natural properties:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="15%" />
<col width="70%" />
<thead>
<tr>
<th align="left" valign="top"> Property </th>
<th align="left" valign="top"> Type </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table">tofile</p></td>
<td align="left" valign="top"><p class="table">file</p></td>
<td align="left" valign="top"><p class="table">create a file based on this string; the so created will be relative to the current build file's base folder if the string's value does not denote a absolute path. Furthermore, the empty string will create a file object denoting the project's base folder (i.e. the folder containing the build script currently executed). Notice that <tt>.</tt> and <tt>..</tt> denote absolute paths, not relative ones.</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">length</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">number of characters in this string</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">size</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">same as property <tt>length</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">tolower</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">return this string in lowercase characters only</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">toupper</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">return this string in uppercase characters only</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">trim</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">remove leading and trailing whitespace characters</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="el_file_properties">3.7.5. File Properties</h4>
<div class="paragraph"><p>Files and folders is Ant's bread and butter. A couple of properties are defined on file objects to simplify scripting (see below). Consider:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="30%" />
<col width="10%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top"> Property </th>
<th align="left" valign="top"> Type </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table"><tt>tourl</tt></p></td>
<td align="left" valign="top"><p class="table">URL</p></td>
<td align="left" valign="top"><p class="table">file as URL object</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>absolutefile</tt></p></td>
<td align="left" valign="top"><p class="table">file</p></td>
<td align="left" valign="top"><p class="table">The absolute form of this abstract pathname</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>absolutepath</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">The absolute form of this abstract pathname</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>canonicalfile</tt></p></td>
<td align="left" valign="top"><p class="table">file</p></td>
<td align="left" valign="top"><p class="table">The canonical form of this abstract pathname</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>canonicalpath</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">The canonical form of this abstract pathname</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>delete</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">deletes the file or folder (true); false otherwise</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>exists</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">check whether file or folder exists</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>isdir</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">check whether a folder (directory)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>isfile</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">check whether a file</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>ishidden</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">check whether a hidden file or folder</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>isread</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">check whether a file or folder is readable</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>iswrite</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">check whether a file or folder is writable</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>length</tt></p></td>
<td align="left" valign="top"><p class="table">integer</p></td>
<td align="left" valign="top"><p class="table">same as <tt>size</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>list</tt></p></td>
<td align="left" valign="top"><p class="table">list</p></td>
<td align="left" valign="top"><p class="table">array of files in folder</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>mkdir</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">creates the folder (and intermediate) folders (true); false otherwise</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>mtime</tt></p></td>
<td align="left" valign="top"><p class="table">Date</p></td>
<td align="left" valign="top"><p class="table">last modification date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>name</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">The basename</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>parent</tt></p></td>
<td align="left" valign="top"><p class="table">file</p></td>
<td align="left" valign="top"><p class="table">parent of file or folder as file object</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>path</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">abstract pathname into a pathname string.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>size</tt></p></td>
<td align="left" valign="top"><p class="table">integer</p></td>
<td align="left" valign="top"><p class="table">number of bytes in a (existing) file; 0 otherwise</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>toabs</tt></p></td>
<td align="left" valign="top"><p class="table">file</p></td>
<td align="left" valign="top"><p class="table">file or folder as absolute file object</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>tostr</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">file name as string object</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>touri</tt></p></td>
<td align="left" valign="top"><p class="table">URI</p></td>
<td align="left" valign="top"><p class="table">file as URI object</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="el_matcher_properties">3.7.6. Matcher Properties</h4>
<div class="paragraph"><p>A <em>matcher object</em> is created by task <a href="#task_switch">[task_switch]</a> if a regular expression matches a input value. Such a matcher object contains details of the match like the start and end position, the pattern used to match and it allows to explore details of capturing groups (also known as <em>marked</em> subexpression).</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="15%" />
<col width="70%" />
<thead>
<tr>
<th align="left" valign="top"> Property </th>
<th align="left" valign="top"> Type     </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table"><em>i</em></p></td>
<td align="left" valign="top"><p class="table">matcher</p></td>
<td align="left" valign="top"><p class="table">The matcher object for <em>i</em>-th capturing group. See task <a href="#task_switch">[task_switch]</a> for examples.</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>start</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">The position within the input where the match starts.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>s</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">Same as <tt>start</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>end</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">The position within the input where the match ends (the character at <tt>end</tt> is the last matching character)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>e</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">Same as <tt>end</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>groups</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">The number of capturing groups in the (regular) expression.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>size</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">Same as <tt>groups</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>length</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">Same as <tt>groups</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>n</tt></p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">Same as <tt>groups</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>pattern</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">The regular expression that was used for this match. Notice that glob expressions are translated into regular expressions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>p</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">Same as <tt>pattern</tt></p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The following example shows how to utilize matcher properties:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch value="foobar"&gt;
   &lt;re expr="^(.*)(b.*)$" var="m"&gt;
     &lt;echo&gt;
       #{ m          }   ; 'foobar'
       #{ m[0]       }   ; 'foobar'
       #{ m.start    }   ; 0
       #{ m.end      }   ; 5
       #{ m.groups   }   ; 2
       #{ m.pattern  }   ; '^(.*)(b.*)$'
       #{ m[1]       }   ; 'foo'
       #{ m[2]       }   ; 'bar'
       #{ m[1].end   }   ; 2
       #{ m[2].start }   ; 3
     &lt;echo&gt;
   &lt;/re&gt;
&lt;/c:switch&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="el_project_properties">3.7.7. Project Properties</h4>
<div class="paragraph"><p>This sections lists additional properties that can be queried on an object of type <tt>project</tt>, i.e. of an Ant project. For natural properties, checkout the Javadoc of class org.apache.tools.ant.Project <span class="footnote"><br />[for example <a href="http://javadoc.haefelinger.it/org.apache.ant/1.7.1/org/apache/tools/ant/Project.html">http://javadoc.haefelinger.it/org.apache.ant/1.7.1/org/apache/tools/ant/Project.html</a>]<br /></span>.</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="15%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top"> Property  </th>
<th align="left" valign="top"> Type </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table"><tt>macrodefs</tt></p></td>
<td align="left" valign="top"><p class="table">list</p></td>
<td align="left" valign="top"><p class="table">A list of all macrodef names</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>basedir</tt></p></td>
<td align="left" valign="top"><p class="table">file</p></td>
<td align="left" valign="top"><p class="table">The project's base directory as file object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>targets</tt></p></td>
<td align="left" valign="top"><p class="table">list</p></td>
<td align="left" valign="top"><p class="table">A list of all target names</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>tasks</tt></p></td>
<td align="left" valign="top"><p class="table">list</p></td>
<td align="left" valign="top"><p class="table">A list of all taskdef and macrodef names</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>taskdefs</tt></p></td>
<td align="left" valign="top"><p class="table">list</p></td>
<td align="left" valign="top"><p class="table">A list of all taskdef names</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="el_type_conversion">3.8. Type Conversion</h3>
<div class="paragraph"><p>Every EL expression is evaluated in the context of an <em>expected</em> type. When a evaluated expression does not match it's expected type, implicit type conversion takes place. The following sections list the rules which apply.</p></div>
<div class="sect3">
<h4 id="_type_boolean">3.8.1. Type boolean</h4>
<div class="paragraph"><p>The following table describes the conversion of object <tt>obj</tt> into an boolean value:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<col width="30%" />
<col width="70%" />
<thead>
<tr>
<th align="left" valign="top"> Type        </th>
<th align="left" valign="top"> Result</th>
</tr>
</thead>
<tfoot>
<tr>
<td align="left" valign="top"><p class="table"><em>other</em></p></td>
<td align="left" valign="top"><p class="table">false</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">null</p></td>
<td align="left" valign="top"><p class="table"><tt>false</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>false</tt> if obj is <tt>""</tt>, otherwise <tt>Boolean.valueof(obj)</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">obj</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">file</p></td>
<td align="left" valign="top"><p class="table"><tt>true</tt> if the file described by obj exists</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part4">4. Property Tasks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="task_properties">4.1. properties</h3>
<div class="paragraph"><p>This task essentially allows one to move the contents of a Ant property file <span class="footnote"><br />[see <a href="http://ant.apache.org/manual/Tasks/property.html">http://ant.apache.org/manual/Tasks/property.html</a>]<br /></span> into a build file.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:properties&gt;
  ; this is a comment

  ; regular properties
  p0 = hello
  p1 : ${p0}, \
       world!

  ; EL references enabled by default
  p2 = hello, #{ 'world' }!
&lt;/c:properties&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>This task is quite similar to <a href="#tasks_let">let</a>. The major difference is that this task is about creating properties in the spirit of Ant while <a href="#tasks_let">let</a> on the other side, supports in addition the creation of variables, overriding and deleting of properties.</p></div>
<div class="sect3">
<h4 id="_attributes">4.1.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="10%" />
<col width="15%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cs</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a comment-line</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>ics</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a inline-comment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cl</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table"><tt>true</tt></p></td>
<td align="left" valign="top"><p class="table">Whether continuation lines shall be supported</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Use an empty attribute value ("") to turn comments off.</p></div>
</div>
<div class="sect3">
<h4 id="_elements">4.1.2. Elements</h4>
<div class="paragraph"><p>This task accepts a implicit text element.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour">4.1.3. Behaviour</h4>
<div class="paragraph"><p>The format to define properties within a this task is a subset of the format supported by Ant. Consider:</p></div>
<div class="ulist"><ul>
<li>
<p>
Ant uses character <tt>#</tt> to start a comment while Flaka uses <tt>;</tt> <span class="footnote"><br />[Use attribute <tt>cs</tt> to change the comment-line character]<br /></span>
</p>
</li>
<li>
<p>
Ant does not support inline comments <span class="footnote"><br />[Use attribute <tt>ics</tt> to change the comment-line character or to turn off this feature]<br /></span>
</p>
</li>
<li>
<p>
Ant comment lines do not support continuation lines, this task does.
</p>
</li>
<li>
<p>
This task requires that either <tt>=</tt> or <tt>:</tt> separates the key from it's value.
</p>
</li>
<li>
<p>
Leading and trailing (!) whitespace characters are ignored. This is different from standard Ant where trailing whitespace is significant <span class="footnote"><br />[.. and responsible for unexpected and hard to track script behaviour]<br /></span>.
</p>
</li>
<li>
<p>
EL-references <tt>#{..}</tt> are resolved regardless of whether EL has been enabled or not.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="task_unset">4.2. unset</h3>
<div class="paragraph"><p>The unset statement allows the removal of properties <span class="footnote"><br />[Removal of user-properties is currently not supported]<br /></span> . Use this task with care as properties are not meant to be changed during execution of a project.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:unset&gt;
   ; remove property p1 ..
   p1
   ; .. and p2
   p\
   2
 &lt;/c:unset&gt;
 &lt;fail if="p1" /&gt;
 &lt;fail if="p2" /&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>You may also use the more universal task <a href="#task_let">[task_let]</a> for property removal.</p></div>
<div class="sect3">
<h4 id="_attributes_2">4.2.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="15%" />
<col width="15%" />
<col width="55%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">debug</p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table"><tt>false</tt></p></td>
<td align="left" valign="top"><p class="table">Turn extra debug information on</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">comment</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The character that starts a comment line</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_elements_2">4.2.2. Elements</h4>
<div class="paragraph"><p>This element accepts implicit text.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour_2">4.2.3. Behaviour</h4>
<div class="paragraph"><p>Each non comment line defines a property name to be removed. Comment lines and empty lines are ignored. Continuation lines are accumulated before being processed. EL-references are resolved. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:unset&gt;
 ; property 'foo bar', not 'foo' and 'bar'
 foo bar

 ; EL references are resolve, so this will remove
 ; property p15.
 p#{3*5}
&lt;/c:unset&gt;</tt></pre>
</div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part3">5. Assignment Tasks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="task_let">5.1. let</h3>
<div class="paragraph"><p>XML is not particular easy to read for humans. When assigning a couple of variables and properties, this becomes obvious. This elementary task allows to set multiple variables and properties in one go. In addition, comments and continuation lines are allowed for additional readability and comfort. For example:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>  &lt;c:let&gt;
    f = 'my/path'
    ; turn f into a file object
    f = file(f)
    b = f.isdir ? true : false
    ; assign a *property*
    p := 'hello world'
    ; override a property if you dare
    p ::= "HELLO \
    WORLD"
  &lt;/c:let&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>In this example, variable <tt>f</tt> is first assigned to be a string object (<tt>'my/path'</tt>). The comment line, the one starting with character <tt>;</tt>, tells what the next line is going to do: turn <tt>f</tt> into a file object which can then be used for further processing. Here we create variable <tt>b</tt> which becomes <tt>true</tt> if <tt>f</tt> is a directory and <tt>false</tt> otherwise.</p></div>
<div class="paragraph"><p>Character <tt>=</tt> is used to create or set a variable while <tt>:=</tt> indicates to create a property instead. If such a property already exists, it will not be changed in accordance with Ant's standard behaviour. If you however dare to override a property, then you may do so using <tt>::=</tt> as the last example shows.</p></div>
<div class="paragraph"><p>Notice that the right side of <tt>=</tt>, <tt>:=</tt> and <tt>::=</tt> is evaluated as EL expression while the left side is expected to constitute a valid identifier for a variable or property.</p></div>
<div class="sect3">
<h4 id="_attributes_3">5.1.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cs</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a comment-line</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>ics</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a inline-comment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cl</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table"><tt>true</tt></p></td>
<td align="left" valign="top"><p class="table">Whether continuation lines shall be supported</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Use an empty attribute value ("") to turn comments off.</p></div>
</div>
<div class="sect3">
<h4 id="_elements_3">5.1.2. Elements</h4>
<div class="paragraph"><p>This task accepts an implicit text element.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour_3">5.1.3. Behaviour</h4>
<div class="paragraph"><p>In a first step, physical lines are processed into logical lines by taking continuation lines into accout. Then, any comments and lines containing only whitespace charactes are stripped from input.</p></div>
<div class="paragraph"><p>Then, each line is taken apart into a key and value by using the first occurrance of <tt>=</tt>, <tt>:=</tt> or <tt>::=</tt>.  as breaking point. Leading and trailing whitespace characters are removed from key and value. Then, property and EL references are resolved . Eventually the value part is evaluated as EL expression and stored as variable or property. When stored as property, the evaluated value will be coerced into a string.</p></div>
</div>
<div class="sect3">
<h4 id="_then_meaning_of_tt_null_tt_and_em_void_em">5.1.4. Then meaning of <tt>null</tt> and <em>void</em></h4>
<div class="paragraph"><p>This task can also be used to <em>remove</em> variables and properties. The following table gives an overview of the meaning of <tt>null</tt> and <em>void</em> <span class="footnote"><br />[<em>void</em> means that the absence of any characters]<br /></span> on the right side of an assignment:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="33%" />
<col width="33%" />
<col width="33%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Assignment Type</p></td>
<td align="left" valign="top"><p class="table">Evaluated Value</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>=</tt></p></td>
<td align="left" valign="top"><p class="table"><tt>null</tt></p></td>
<td align="left" valign="top"><p class="table">Remove variable if existing, else do nothing</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>=</tt></p></td>
<td align="left" valign="top"><p class="table"><em>void</em></p></td>
<td align="left" valign="top"><p class="table">Same as <tt>= null</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>:=</tt></p></td>
<td align="left" valign="top"><p class="table"><tt>null</tt></p></td>
<td align="left" valign="top"><p class="table">Nothing</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>:=</tt></p></td>
<td align="left" valign="top"><p class="table"><em>void</em></p></td>
<td align="left" valign="top"><p class="table">Same as <tt>:= null</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>::=</tt></p></td>
<td align="left" valign="top"><p class="table"><tt>null</tt></p></td>
<td align="left" valign="top"><p class="table">Remove property</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>::=</tt></p></td>
<td align="left" valign="top"><p class="table"><em>void</em></p></td>
<td align="left" valign="top"><p class="table">Same as <tt>::= null</tt></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_examples">5.1.5. Examples</h4>
<div class="paragraph"><p>To start with, some basic examples.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:let&gt;
 ; a comment line
 ; variable x will hold integer 12
 x   = 3 * 4
 ; property p will hold string '12'
 p  := 3 * 4
 ; ignored, cause property p exists already
 p  := 'twelve'
 ; override property p to hold string value '12'
 p ::= 'twelve'
&lt;/c:let&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>It is perfectly legal to use property or variable references. Variables and properties created within <tt>let</tt> can also be used. Be aware that property references are resolved <em>before</em> EL references. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;property name="a" value="a" /&gt;
&lt;c:let&gt;
 ; variabe v becomes the string object 'bar' and property p
 ; becomes 'foobar'
 v  = 'b${a}r'
 p := 'foo#{v}'
 ; property- and El-references can be used on both sides. Here we
 ; override property 'a' to become string value `bar`
 ${a} ::= '#{v}'
 ; This will not work as planned cause there is no property
 ; with that weired name '#{v}'.
 f = ${#{v}}
&lt;/c:let&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The following kind of meta programming will <em>not</em> work for <tt>let</tt> cause property and EL references are resolved after the logical line has been broken up in a key and value part:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:let&gt;
  ; This example will NOT work as planned
  assigntype := condition ? '=' : ':='
  key ${assigntype} el-expr
&lt;/c:let&gt;</tt></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="task_list">5.2. list</h3>
<div class="paragraph"><p>A elementary task to create a variable containing a <em>list</em> of objects.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:list var="mylist"&gt;
  ;; each line is a EL expression
  3 * 5
  ;; each line defines a list element
  list('a',1,''.tofile)
&lt;/c:list&gt;</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_4">5.2.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table"><a href="#el">[el]</a></p></td>
<td align="left" valign="top"><p class="table">Meaning</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">var</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">r</p></td>
<td align="left" valign="top"><p class="table">The name of the variable to be assigned.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">el</p></td>
<td align="left" valign="top"><p class="table">bool</p></td>
<td align="left" valign="top"><p class="table">true</p></td>
<td align="left" valign="top"><p class="table">no</p></td>
<td align="left" valign="top"><p class="table">Enable evaluation as EL expression</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cs</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a comment-line</p></td>
<td align="left" valign="top"><p class="table"><tt>ics</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a inline-comment</p></td>
<td align="left" valign="top"><p class="table"><tt>cl</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Use an empty attribute value ("") to turn comments off.</p></div>
</div>
<div class="sect3">
<h4 id="_elements_4">5.2.2. Elements</h4>
<div class="paragraph"><p>This task may contain a implicit text element.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour_4">5.2.3. Behaviour</h4>
<div class="paragraph"><p>This task creates and assigns in any case a (possible) empty list, especially if no text element is present. The name of the variable is given by attribute <tt>var</tt>. This attribute may contain references to EL expressions.</p></div>
<div class="paragraph"><p>If given text element is parsed on a line by line basis, honouring comments and continuation lines. Each line will be evaluated as EL expression after having resolved <tt>${..}</tt> and <tt>#{..}</tt> references. A illegal EL expression will be discarded while the evaluation of lines continues. Turn on extra debug information in case of problems.</p></div>
<div class="paragraph"><p>The evaluation of a valid EL expression results in an object. Each such object will be added to a list in the order imposed by the lines.</p></div>
<div class="paragraph"><p>A single line can&#8217;t have more than one EL expressions. Thus the following example is invalid:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:list var="mylist"&gt;
 ;; not working
 3 * 5  'hello, world'
&lt;/c:list&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Use attribute <tt>el</tt> to disable the interpretation of a line as <a href="#el">[el]</a> expression:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:list var="mystrings" el="false"&gt;
 3 * 5
 ;; assume that variable message has (string) value 'world'
 hello, #{message}
&lt;/c:list&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>This creates a list variable <tt>mystrings</tt> containing two elements. The first element will be string <tt>3 * 5</tt> and the second element will be string <tt>hello, world</tt>. Notice that even if EL evaluation has been turned off, EL references can still be used.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part5">6. Reporting Tasks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="task_echo">6.1. echo</h3>
<div class="paragraph"><p>Task <tt>&lt;c:echo/&gt;</tt> is an extension of Ant's standard <tt>echo</tt> task <span class="footnote"><br />[see <a href="http://ant.apache.org/manual/Tasks/echo.html">http://ant.apache.org/manual/Tasks/echo.html</a>]<br /></span> to generate nicly formatted output.  Ant's standard <tt>echo</tt> task is rather fragile when it comes to reformatting XML. Here is a simple example where the output dumped is shown on the right side:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;foobar&lt;/echo&gt;       ; '[echo] foobar'</tt></pre>
</div></div>
<div class="paragraph"><p>Then, one day you reformat your XML input <span class="footnote"><br />[<a href="http://xmlsoft.org/xmllint.html">xmlint</a> is a good choice]<br /></span> ending up in <span class="footnote"><br />[In order to visualize space characters, character dot (<tt>.</tt>) is going to be used within this chapter]<br /></span></p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;echo&gt;                   ; '[echo]'
...foobar                ; '[echo] ...foobar'
&lt;/echo&gt;                  ; '[echo]'</tt></pre>
</div></div>
<div class="paragraph"><p>All of a sudden there are three more space characters in front of <tt>foobar</tt> and, to make matters worse, there are two additional empty lines printed. Compare this output with Flaka's <tt>echo</tt></p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo&gt;
  foobar                 ; '[c:echo] foobar'
&lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>which I believe is what you had in mind. Besides being invariant regarding formatting, <tt>echo</tt> supports other features in helping to generate pretty output.</p></div>
<div class="sect3">
<h4 id="_attributes_5">6.1.1. Attributes</h4>
<div class="paragraph"><p>This tasks supports all attributes inherited from Ant's echo task. In addition, further supported attributes are:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="15%" />
<col width="15%" />
<col width="55%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cs</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a comment-line</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>ics</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a inline-comment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cl</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table"><tt>true</tt></p></td>
<td align="left" valign="top"><p class="table">Whether continuation lines shall be supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>ws</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table"><tt>true</tt></p></td>
<td align="left" valign="top"><p class="table">Whether whitespace shall be stripped off</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>shift</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">``</p></td>
<td align="left" valign="top"><p class="table">Prefix for each output line</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_elements_5">6.1.2. Elements</h4>
<div class="paragraph"><p>This task optionally accepts implicit text.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour_5">6.1.3. Behaviour</h4>
<div class="paragraph"><p>In an initial step, continuation lines are merged into logical lines. Then any comments are stripped from input. Afterwards, unwanted whitespace characters are removed. The process is illustrated <span class="footnote"><br />[Again character dot <tt>.</tt> is used to illustrate a whitespace character with the exception of line ending characters]<br /></span> using the introduction example used above:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo&gt;
..foo                ; 'foo'
...bar               ; '.bar'
.baz                 ; 'baz'
&lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The whitespace sequence before the first non-whitespace character is analyzsed: if this sequence does not contain any line-ending characters, no whitespace handling will occur. Otherwise, the number of whitespace characters before the first non-whitespace character and after the last line-ending character is determined. This will be <tt>2</tt> in the example above. Then, the whole printable content is being <tt>left shifted</tt> by this amount. Eventually, the content is trimmed: leading whitespace up and inclusive the first line-ending character as well as the last line-ending character followed by trailing whitespace is removed. This gives then the output shown as above. Notice that <tt>foo</tt> and <tt>baz</tt> are now on the same idendation level by this left-shift. It is possible to perform a <tt>right-shift</tt> of content <em>after</em> the automatic left shift:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo shift="5"&gt;
..foo                ; '.....foo'
&lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Attribute <tt>shift</tt> expects a unsigned integral number followed by an optinal arbitrary sequence of characters. This allows for a different <em>shift</em> character sequence as show next:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo shift="5&gt; "&gt;
..foobar              ; '&gt; &gt; &gt; &gt; &gt;foobar'
&lt;/c:echo&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_examples_2">6.1.4. Examples</h4>
<div class="paragraph"><p>Create a single output line consisting of 20 times character <tt>%</tt>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo shift="20%" /&gt;   ; '%%%%%%%%%%%%%%%%%%%%'</tt></pre>
</div></div>
<div class="paragraph"><p>Type a comment in echo to document what will be echoed:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo&gt;
  ; make sure that property p is defined here
  p : ${p}         ; 'p : ..'
&lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Follow the guideline that lines should not exceed 80 characters by using continuation lines if necessary</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo&gt;
  a very long \    ; 'a very long line'
  line
&lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p><a href="#el">EL</a> is enabled by default:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo&gt;
  #{3 * 4}   ; '12'
&lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The comment character sequence can be changed or disabled:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo cl="#" ic=""&gt;
  #{3 * 4}   you cannot see me
  not ; any longer an inline comment!
&lt;/c:echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>You can use <tt>\</tt> as start of an escape sequence while however <tt>\\</tt> does not escape <tt>\</tt> from it's meaning. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:echo&gt;
  \#{3 * 4}            ; '#{3 * 4}'
  \\#{3 * 4}           ; '\#{3 * 4}'
  #{ '\\' }#{3 * 4}    ; '\12'
  #{ concat('\\',3*4)} ; '\12'
  ; comment            ;
  \; not a comment     ; '; not a comment'
  \\; not a comment    ; '\; not a comment'
&lt;/c:echo&gt;</tt></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="task_logo">6.2. logo</h3>
<div class="paragraph"><p>A small handy task to create a kind of <em>framed</em> text like</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>:::::::::::::::::::::::::::::::::::::
::             Text                ::
::          more text              ::
:::::::::::::::::::::::::::::::::::::</tt></pre>
</div></div>
<div class="paragraph"><p>This kind of <em>logo</em> is easily created and dumped on standard output stream like</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:logo chr="::" width="20"&gt;
  ;; here is my text
  Text
  more text
&lt;/c:logo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>where <tt>chr</tt> defines the <em>wrap character</em> - here <tt>::</tt> and <tt>width</tt> defines the overall length of one line - here 20 characters.</p></div>
<div class="sect3">
<h4 id="_attributes_6">6.2.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="15%" />
<col width="15%" />
<col width="55%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attributes</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">chr</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>:</tt></p></td>
<td align="left" valign="top"><p class="table">The wrapping character ..</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">width</p></td>
<td align="left" valign="top"><p class="table">integer</p></td>
<td align="left" valign="top"><p class="table"><tt>80</tt></p></td>
<td align="left" valign="top"><p class="table">Width of one line in terms of regular characters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cs</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a comment-line</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>ics</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>;</tt></p></td>
<td align="left" valign="top"><p class="table">The sequence starting a inline-comment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cl</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table"><tt>true</tt></p></td>
<td align="left" valign="top"><p class="table">Whether continuation lines shall be supported</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Use an empty attribute value ("") to turn comments off.</p></div>
</div>
<div class="sect3">
<h4 id="_elements_6">6.2.2. Elements</h4>
<div class="paragraph"><p>This task accepts an implicit text field. This text field may contain comments (<tt>;</tt>) and leading whitespace is ignored. Thus the same rules as for task <a href="#task_echo">[task_echo]</a> are applying here.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour_6">6.2.3. Behaviour</h4>
<div class="paragraph"><p>Contents of text element is read line by line. Comment lines are ignored. Leading whitespace is ignored. Leading whitespace is determined by the first non-whitespace character. See also task <a href="#task_echo">[task_echo]</a> for details.</p></div>
<div class="paragraph"><p>The contents of each line is centered. Leading and trailing space is filled up with <em>blanks_</em> in order to reach the given line width. If a line is longer than <tt>width</tt>, then all contents after <tt>width</tt> characters is silently skipped.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part6">7. Conditional Tasks</h2>
<div class="sectionbody">
<div class="paragraph"><p>With standard Ant, task <a href="http://ant.apache.org/manual/CoreTasks/condition.html">condition</a> is used to set a property if a condition is given. Then a macro, task or target can be conditionally executed  by checking the existence or absence of that property (using standard attributes <em>if</em> or <em>unless</em>. Flaka defines a couple of control structures to handle conditionals in a simpler way.</p></div>
<div class="paragraph"><p>Task <a href="#task_when">[task_when]</a> evaluates an <a href="#el">[el]</a> expressio. If the evaluation gives <tt>true</tt>, the sequence of tasks are executed. Nothing else happens in case of <tt>false</tt>.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:when test=" expr "&gt;
   ; executed if expr evaluates to true
&lt;/c:when&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The logical negation of <tt>when</tt> is task <a href="#task_unless">[task_unless]</a> which executes the sequence of tasks only in case the evaluation of <em>expr</em> returns <tt>false</tt>.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:unless test=" expr "&gt;
   ; executed if expr evaluates to false
 &lt;/c:unless&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The body of <tt>when</tt> and <tt>unset</tt> may contain any sequence of tasks or macros (or a combination of both).</p></div>
<div class="paragraph"><p>Task <a href="#task_choose">[task_choose]</a> tests each <tt>when</tt> condition in turn until an <em>expr</em> evalutes to <tt>true</tt>. It executes then the body of that when condition. Subsequent <tt>whens</tt> are then not further tested (nor executed). If all expressions evaluate to <tt>false</tt>, an optional <em>catch-all</em> clause gets executed.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:choose&gt;
  &lt;when test="expr_1"&gt;
    ; body_1
  &lt;/when&gt;
  ..
  &lt;otherwise&gt; ; optional_
    ; catch all body
  &lt;/otherwise&gt;
 &lt;c:/choose&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>A programming task often seen is to check whether a (string) value matches a given (string) value. If so, a particular action shall be carried out. This can be done via a series of <em>when</em> statements. The nasty thing is to keep track of whether a value matched already. Flaka provides a handy task for this common scenario, the <a href="#task_switch">[task_switch]</a> task:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:switch value=" 'some string' "&gt;
  &lt;matches re="regular expression or pattern" &gt;
    ; body_1
  &lt;/case&gt;
  ..
  &lt;otherwise&gt; ; optional
    ; catch all body
  &lt;/otherwise&gt;
 &lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Each case is tried in turn <em>to match</em> the string value (given as <a href="#el">[el]</a> expression). If a case matches, the appropriate case body is executed. If it happens that no case matches, then the optional default body is executed. To be of greater value, a regular expression or pattern expression can be used in a case condition.</p></div>
<div class="sect2">
<h3 id="task_when">7.1. when</h3>
<div class="paragraph"><p>Task when represents a else-less if statement. The following example dumps the content of a file to stdout via Ant's echo task if the file exists.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:when test=" 'path/to/file'.tofile.isfile" &gt;
   &lt;c:let var="fname" property="true" value=" f " /&gt;
    &lt;loadfile property="__z__" srcFile="${fname}"/&gt;
    &lt;echo message="${__z__}" /&gt;
 &lt;/c:when&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Note that the example is bit artificial cause Ant's loadfile task is sufficient.</p></div>
<div class="sect3">
<h4 id="_attributes_7">7.1.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="52%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">EL</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>test</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>false</tt></p></td>
<td align="left" valign="top"><p class="table">expr</p></td>
<td align="left" valign="top"><p class="table">A <a href="#el">[el]</a> expression that must evaluate to <tt>true</tt> in order to execute the body of this if statement.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_elements_7">7.1.2. Elements</h4>
<div class="ulist"><ul>
<li>
<p>
Any tasks or macro instances.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="task_unless">7.2. unless</h3>
<div class="paragraph"><p>This task is the logical opposite of task <a href="#tasks_when">when</a>. It's body is only executed if the condition evaluates to false. See <a href="#tasks_when">when</a> for details. This example shows how to create a folder named libdir if such a folder does not already exist.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:unless test=" 'libdir'.tofile.isdir "&gt;
  &lt;mkdir dir="libdir" /&gt;
 &lt;/c:unless&gt;</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="task_choose">7.3. choose</h3>
<div class="paragraph"><p>A task implementing a series of <em>ifelse</em> statements, i.e. a generalized <em>if-then-else</em> statement.</p></div>
<div class="sect3">
<h4 id="_attributes_8">7.3.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="52%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">EL</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>when</em>.test</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>false</tt></p></td>
<td align="left" valign="top"><p class="table">=</p></td>
<td align="left" valign="top"><p class="table">A EL condition. When <tt>true</tt> corresponding clause will be executed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>unless</em>.test</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>true</tt></p></td>
<td align="left" valign="top"><p class="table">=</p></td>
<td align="left" valign="top"><p class="table">A EL condition. When <tt>false</tt> corresponding clause will be executed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">debug</p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table"><tt>false</tt></p></td>
<td align="left" valign="top"><p class="table">=</p></td>
<td align="left" valign="top"><p class="table">Turn on extra debug information.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_elements_8">7.3.2. Elements</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="35%" />
<col width="50%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Element</p></td>
<td align="left" valign="top"><p class="table">Cardinality</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">when</p></td>
<td align="left" valign="top"><p class="table">infinite</p></td>
<td align="left" valign="top"><p class="table">To be executed if condition evaluates to <tt>true</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">unless</p></td>
<td align="left" valign="top"><p class="table">infinite</p></td>
<td align="left" valign="top"><p class="table">To be executed if condition evaluates to <tt>false</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">otherwise</p></td>
<td align="left" valign="top"><p class="table">[0,1]</p></td>
<td align="left" valign="top"><p class="table">To be executed if no <tt>when</tt> or <tt>unless</tt> clause got executed</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">default</p></td>
<td align="left" valign="top"><p class="table">[0,1]</p></td>
<td align="left" valign="top"><p class="table">Synonym for <tt>otherwise</tt></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_behaviour_7">7.3.3. Behaviour</h4>
<div class="paragraph"><p>Each <tt>when</tt> and <tt>unless</tt> clause's conditions are evaluated in order given until a claus get's executed. Then, further processing stops ignoring all further elements not taken into account so far. If no <tt>when</tt> or <tt>unless</tt> clause got executed, then a present <tt>otherwise</tt> or <tt>default</tt> clause gets executed.</p></div>
<div class="paragraph"><p>The shortest possible <tt>choose</tt> statement is</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:choose /&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>It's useless and does nothing, it's completely harmless.</p></div>
<div class="paragraph"><p>The following example would execute all macros or tasks listed in the <tt>otherwise</tt> clause cause no <tt>when</tt> or <tt>unless</tt> clause got executed.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:choose&gt;
  &lt;otherwise&gt;
    &lt;!-- macros/tasks --&gt;
  &lt;/otherwise&gt;
 &lt;/c:choose&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>This would execute all macros and tasks listed in the otherwise clause since no when clause got executed.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:choose&gt;
   &lt;when test=" true == false" &gt;
     &lt;echo&gt;new boolean logic detected ..&lt;/echo&gt;
   &lt;/when&gt;
   &lt;unless test=" 'mydir'.tofile.isdir "&gt;
     &lt;echo&gt; directory mydir exists already &lt;/echo&gt;
   &lt;/when&gt;
   &lt;otherwise&gt;
     &lt;echo&gt; Hello,&lt;/echo&gt;
     &lt;echo&gt;World&lt;/echo&gt;
   &lt;/otherwise&gt;
 &lt;/c:choose&gt;</tt></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="task_switch">7.4. switch</h3>
<div class="paragraph"><p>Task <tt>switch</tt> provides text based pattern matching. An illustrative example:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:switch value="${value}"&gt;
  &lt;re expr="(+|-)?(0|[1-9]\d*)" var="g"&gt;        (1)
    &lt;c:echo&gt;
      integer with absolute value: #{g[2]}
    &lt;/c:echo&gt;
  &lt;/re&gt;
  &lt;glob expr"*.jar"&gt;                            (2)
   &lt;echo&gt;It is a -- jar!&lt;/echo&gt;
  &lt;/glob&gt;
  &lt;cmp eq="foo" lt="foo"&gt;                       (3)
    &lt;!--  ${val} is less or equals "foo" --&gt;
  &lt;/cmp&gt;
  &lt;otherwise&gt;
    &lt;!-- none of the above clauses matched --&gt;
  &lt;/otherwise&gt;
 &lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>This example demonstrates, how a given textual value can be compared using (1) regular expressions, (2) using glob expression or (3) compared for equality or alphabetical order. Why providing alternatives for regular expressions? Cause the biggest drawback of regular expressions is their complexity. Compare this two variations to check whether a string value ends in <tt>.jar</tt>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;re="(.*)\.jar" var="g"&gt;
  &lt;c:echo&gt;
    basename is #{g[1]}.
  &lt;/c:echo&gt;
&lt;/re&gt;

&lt;glob="*.jar" var="g"&gt;
  &lt;c:echo&gt;
    filename is #{g[0]}.
  &lt;/c:echo&gt;
&lt;/glob&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The latter one, the glob expression, is much easier to grasp. There, <tt>*</tt> just stands for a sequence of arbitrary characters. In most pattern recognition tasks, this is all what is needed to get going. If more power is required, then regular expressions are the tool to be applied. Eventually <tt>cmp</tt> allows for simple text comparison without any meta-characters. It also allows to check whether the input string is before or after a given test string.</p></div>
<div class="sect3">
<h4 id="_attributes_9">7.4.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="11%" />
<col width="11%" />
<col width="58%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>value</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">""</p></td>
<td align="left" valign="top"><p class="table">The string value that needs to be matched against.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>var</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table">Save details of this match as <tt>matching object</tt>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>not</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether to invert the test result or not.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>find</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether to match the input value partially (true) or as a whole (false)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>debug</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether to turn on extra debug information</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>literally</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether to take an invalid expression literally or not.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>ignorecase</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether to enable case-insensitive matching.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>comments</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether to allow whitespace and comments in an <em>regex</em>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>dotall</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether literal <tt>.</tt> matches <em>any</em> character.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>unixlines</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether <em>only</em> <tt>nl</tt> is accepted as line terminator</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>multiline</tt></p></td>
<td align="left" valign="top"><p class="table">boolean</p></td>
<td align="left" valign="top"><p class="table">false</p></td>
<td align="left" valign="top"><p class="table">Whether <tt>^</tt> and <tt>$</tt> shall <em>only</em> match begin and end of input</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>re</em>.<tt>expr</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">Element <tt>matches</tt>: Specify a matching pattern as regular expression.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>glob</em>.<tt>expr</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">Element <tt>matches</tt>: Specify a matching pattern as glob expression</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>cmp</em>.<tt>lt</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table"><tt>&lt;cmp/&gt;</tt>: Specify a matching pattern as glob expression</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>cmp</em>.<tt>eq</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table"><tt>&lt;cmp/&gt;</tt>: Specify a matching pattern as glob expression</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>cmp</em>.<tt>gt</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table"><tt>&lt;cmp/&gt;</tt>: Specify a matching pattern as glob expression</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Attribute <strong>value</strong> defines the test (string) value. EL <a href="#el">[el]</a> references can be used. Leading and trailing whitespace is always removed. A test of a clause will always evaluate to <tt>false</tt> if this attribute is not set. It is legal however to have a switch without this attribute.</p></div>
<div class="paragraph"><p>The default settings of attributes <strong>var</strong>, .., <strong>debug</strong> have been shown in table above. A default setting can be changed by using the attribute on switch element level. Those default settings are inherited by each clause-element - <tt>&lt;re/&gt;</tt>, <tt>&lt;glob/&gt;</tt> or <tt>&lt;cmp/&gt;</tt>. Each attribute <strong>var</strong>,.., <strong>debug</strong> can be applied on clause-elements where they override their inherited setting:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:switch .. not="true"&gt;
  ..
  &lt;cmp eq="foo" lt="foo" not="false"&gt;
    &lt;!-- still less then "foo" or equal "foo" --&gt;
  &lt;/cmp&gt;
 &lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Use attribute <strong>var</strong> to specify the name of an EL variable to hold match details like the number of capturing groups, the value of the first capturing group and the like. See <a href="#el_matcher_properties">matcher properties</a> for a list of available properties; see also below for examples. The attribute value may contain EL references.</p></div>
<div class="paragraph"><p>Attribute <strong>not</strong> can be used to invert the result of a test match.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:switch ..&gt;
  &lt;cmp eq="foo" lt="foo" not="true"&gt;
    &lt;!-- greater then "foo"  --&gt;
  &lt;/cmp&gt;
 &lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>When applying a regular or glob expression on a test value, then by default, the expression must describe the whole test value for a successful match. Attribute <strong>find</strong> can be used to change this behaviour. Set to <tt>true</tt>, then a successful match is given if the expression describes a part of the input string:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:switch value="foobar"&gt;
  &lt;glob find="true" expr="foo"&gt;
    &lt;!-- matches foobar --&gt;
  &lt;/glob&gt;
 &lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Attribute <strong>find</strong> does not apply on clause <tt>cmp</tt>.</p></div>
<div class="paragraph"><p>Use attribute <strong>debug</strong> to enable extra output of debug information on your attached standard error stream, bypassing Ant's logging mechanics.</p></div>
<div class="paragraph"><p>The semantics of attribute <strong>literally</strong> varies depending on it's context. A build failure is thrown if an illegal regular expression pattern - like <tt>*</tt> - is seen. If literally is enabled, the regular expression string is taken literally instead, no exception is thrown while a warning message is reported. If attribute <strong>literally</strong> is enabled in context of a glob expression, then any meta characters are taken as regular characters. Attribute <strong>literally</strong> has no meaning in the context of clause <tt>cmp</tt>.</p></div>
<div class="paragraph"><p>The remaining part of this section describes attributes <strong>ignorecase</strong>, .., <strong>multiline</strong>. This attributes can be used to change the characteristics of the underlying regular expression engine. Modern regular expression engines also allow to their characteristics on the fly by using embedded flags. Embedded flag alternatives are also listed.</p></div>
<div class="paragraph"><p>Attribute <strong>ignorecase</strong> can be used to enable case-insensitive matching. This attribute also applies to clause <tt>cmp</tt>. Case-insensitive matching is enabled on the US-ASCII charset only. Unicode-aware matching can not be enabled. The embedded flag expression equivalent flag of this attribute is <tt>(?i)</tt>.</p></div>
<div class="paragraph"><p>Use attribute <strong>comment</strong> to enrich regular expressions by comments. When set, whitespace is ignored and embedded comments starting with # are ignored until the end of a line. Comments mode can also be enabled via the embedded flag expression <tt>(?x)</tt>.</p></div>
<div class="paragraph"><p>Attribute <strong>dotall</strong> can be used to change the characteristics of meta-character <tt>.</tt>, the dot. By default all characters but line terminators are matched by this meta-character. When set, all characters are matched. The embedded equivalent is <tt>(?s)</tt> .</p></div>
<div class="paragraph"><p>Use attribute <strong>unixlines</strong> to let the regular expression engine accept <tt>\n</tt> as line termination character. The embedded flag expression is <tt>(?d)</tt>.</p></div>
<div class="paragraph"><p>Attribute <strong>multiline</strong> changes the characteristics of meta-character <tt>^</tt> and <tt>$</tt>. By default they match at the beginning and the end of the entire input sequence. When set, they match just after and just before a line termination character. Multiline mode can also be enabled via the embedded flag expression (?m).</p></div>
</div>
<div class="sect3">
<h4 id="_elements_9">7.4.2. Elements</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="35%" />
<col width="50%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Element</p></td>
<td align="left" valign="top"><p class="table">Cardinality</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>re</tt></p></td>
<td align="left" valign="top"><p class="table">arbitrary</p></td>
<td align="left" valign="top"><p class="table">Regular expression based test clause.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>glob</tt></p></td>
<td align="left" valign="top"><p class="table">arbitrary</p></td>
<td align="left" valign="top"><p class="table">Glob expression based test clause.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>cmp</tt></p></td>
<td align="left" valign="top"><p class="table">arbitrary</p></td>
<td align="left" valign="top"><p class="table">Clause for basic equality and ordering.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>otherwise</tt></p></td>
<td align="left" valign="top"><p class="table">arbitrary</p></td>
<td align="left" valign="top"><p class="table">Task container, executed if all tests failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>matches</tt></p></td>
<td align="left" valign="top"><p class="table">arbitrary</p></td>
<td align="left" valign="top"><p class="table">Legacy test clause (deprecated).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Element <strong>re</strong> is a task container. Embedded tasks are conditionally carried out. The condition is satisfied if the regular expression expressed in attribute <strong>expr</strong> matches the given input value <em>switch</em>.<tt>value</tt>. If attribute <strong>expr</strong> is not used, then the condition is satisfied. Use attribute <strong>not</strong> to negate the condition. Be aware of the following pathological case:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:switch value=..&gt;
  &lt;re&gt;
    &lt;!-- always carried out --&gt;
  &lt;/re&gt;
 &lt;c:case&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Element <strong>glob</strong> is a task container similar to element <strong>re</strong>. The only difference is, that attribute <strong>expr</strong> is interpreted as glob expression instead of a regular expression as in <strong>re</strong>.</p></div>
<div class="paragraph"><p>Element <strong>cmp</strong> is a task container similar to element <strong>re</strong> and <strong>glob</strong>. This element supports attributes <strong>lt</strong>, <strong>eq</strong> and <strong>gt</strong> in addition to inherited attributes. Embedded tasks are carried out if each comparison in each used attribute evaluates to true. If none of the attributes is used, then the condition is also satisfied.</p></div>
<div class="paragraph"><p>Element <strong>otherwise</strong> does not express a test clause and does not support any attributes. This element is a task container. Embedded tasks are carried out if attribute <em>switch</em>.<tt>value</tt> has been set and if none of the test-clauses matched. This element can be present more than once. Elements are carried out in syntactical order.</p></div>
<div class="paragraph"><p>Element <strong>default</strong> is an alias name for element <tt>otherwise</tt>.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour_8">7.4.3. Behaviour</h4>
<div class="paragraph"><p>String attribute <tt>value</tt> is applied against a series of <em>case</em>-clauses in their syntactical order. Elements <tt>re</tt>, <tt>glob</tt>, <tt>cmp</tt> and <tt>matches</tt> are <em>case</em>-clauses. If a clause matches, then tasks associated with the matching clause are carried out and no further clauses are will be tested. If no case-clause matches, then all optional available <tt>otherwise</tt> elements are carried out in their syntactical order.</p></div>
</div>
<div class="sect3">
<h4 id="_examples_3">7.4.4. Examples</h4>
<div class="paragraph"><p>Tests based on regular expressions</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch value="foobar"&gt;
   &lt;re expr="^foobar$" /&gt;     ; matches
   &lt;re expr="foobar" /&gt;       ; matches
   &lt;re expr="foo" /&gt;          ; no
   &lt;re expr="foo" find="true" ; matches
   &lt;re expr="#{'foobar'}"     ; matches
&lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The following example shows how to utilize matcher properties:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch value="foobar"&gt;
   &lt;re expr="^(.*)(b.*)$" var="m"&gt;
     &lt;echo&gt;
       #{ m          }   ; 'foobar'
       #{ m[0]       }   ; 'foobar'
       #{ m.start    }   ; 0
       #{ m.end      }   ; 5
       #{ m.groups   }   ; 2
       #{ m.pattern  }   ; '^(.*)(b.*)$'
       #{ m[1]       }   ; 'foo'
       #{ m[2]       }   ; 'bar'
       #{ m[1].end   }   ; 2
       #{ m[2].start }   ; 3
     &lt;echo&gt;
   &lt;/re&gt;
&lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Tests using glob expressions</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch value="foobar"&gt;
   &lt;glob expr="foobar" /&gt;          ; matches
   &lt;glob expr="f*r" /&gt;             ; matches
   &lt;glob expr="foo" /&gt;             ; no
   &lt;glob expr="foo" find="true" /&gt; ; matches
   &lt;glob expr="#{'foobar'}" /&gt;     ; matches
&lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Matcher properties can also be used when using glob expressions. However, since glob expressions do not have enough semantics to express capturing groups, their use is limited. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch value="foobar"&gt;
   &lt;glob expr="f*r" var="m"&gt;
     &lt;echo&gt;
       #{ m          }   ; 'foobar'
       #{ m[0]       }   ; 'foobar'
       #{ m.start    }   ; 0
       #{ m.end      }   ; 5
       #{ m.groups   }   ; 0
       #{ m.pattern  }   ; 'f.*b'
       #{ m[1]       }   ; ''
     &lt;echo&gt;
   &lt;/glob&gt;
&lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Finally use element <tt>cmp</tt> to do text based comparison in absence of any meta characters. Since element <tt>cmp</tt> is not based on an regular expression engine, matcher properties are not available. Consider</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch value="foobar"&gt;
   &lt;cmp eq="foobar" /&gt;           ; matches
   &lt;cmp eq="f*r"    /&gt;           ; no
   &lt;cmp eq="foo" find="true"/&gt;   ; no
&lt;/c:switch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Element <tt>cmp</tt> can be used to sort text in alphabetical order. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch value="b"&gt;
   &lt;cmp eq="b" /&gt;           ; true
   &lt;cmp lt="c" /&gt;           ; true
   &lt;cmp gt="a" /&gt;           ; true
   &lt;cmp lt="a" eq="b" /&gt;    ; true
&lt;/c:switch&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_pathological">7.4.5. Pathological</h4>
<div class="paragraph"><p>Switch has been designed to be rather tolerant. No elements are required in which case of course nothing happens.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch /&gt;
&lt;c:switch value="foobar" /&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>An <tt>otherwise</tt> elements is carried out if not <em>case</em>-clause matches, especially in the case of absent <em>case</em>-clauses:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:switch&gt;
 &lt;otherwise&gt;
  &lt;echo&gt;executed, cause nothing matched.&lt;/echo&gt;
 &lt;/otherwise&gt;
&lt;/c:switch&gt;</tt></pre>
</div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part7">8. Repetative Tasks</h2>
<div class="sectionbody">
<div class="paragraph"><p>Flaka has a looping statement. Use task <a href="#task_for">[task_for]</a> to iterate over a <em>list</em> of items. Use <a href="#task_break">[task_break]</a> and <a href="#task_continue">[task_continue]</a> to terminate the loop or to continue the loop with the next item.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:for var=" name " in=" ''.tofile.list "&gt;
    ; sequence of task or macros
    ; used &lt;c:continue /&gt; to continue ; and
    ; &lt;c:break /&gt; to stop looping
    ; use #{name} to refer to current item (as shown below)
    &lt;c:echo&gt;#{name}&lt;/c:echo&gt;
 &lt;/c:for&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Attribute <tt>in</tt> will be evaluated as <a href="#el">[el]</a> expression. In the example above, that <a href="#el">[el]</a> expression is <tt>''.tofile.list</tt> which, when evaluated, creates a list of all files in the folder containing the current build script. To understand the expression, have a look at <a href="#el_string_properties">properties</a> of a string and <a href="#el_file_properties">properties</a> of a file.</p></div>
<div class="sect2">
<h3 id="task_while">8.1. while</h3>
<div class="paragraph"><p>A task using a <tt>while</tt> loop:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:let&gt;
  countdown = 3
&lt;/c:let&gt;
&lt;c:while test=" countdown &gt;= 0 "&gt;
  &lt;c:echo&gt;
    #{countdown &gt; 0 ? countdown : 'bang!' }..
  &lt;/c:echo&gt;
  &lt;c:let&gt;
    countdown = countdown - 1
  &lt;/c:let&gt;
&lt;c:while&gt;</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_10">8.1.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="52%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">EL</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>test</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>false</tt></p></td>
<td align="left" valign="top"><p class="table">expr</p></td>
<td align="left" valign="top"><p class="table">The condition for looping as <a href="#el">[el]</a> expression</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_elements_10">8.1.2. Elements</h4>
<div class="literalblock">
<div class="content">
<pre><tt>The body of this task may contain an arbitrary number of tasks or macros.</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_behaviour_9">8.1.3. Behaviour</h4>
<div class="paragraph"><p>All tasks listed as elements are executed as long as the <a href="#el">[el]</a> expression evaluates to <tt>true</tt>.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="task_for">8.2. for</h3>
<div class="paragraph"><p>A task that implements a loop statement. Iterating over a list of <em>objects</em>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:for var="x" in=" list('a', 2, 'src'.tofile, typeof(list())) "&gt;
   &lt;c:echo&gt;
      #{x}
   &lt;/c:echo&gt;
 &lt;/c:for&gt;</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_11">8.2.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="52%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">EL</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>var</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">#{}</p></td>
<td align="left" valign="top"><p class="table">The variable holding each loop item. This variable can be referenced within the body like <tt>#{var}</tt> where <tt>var</tt> is the string used in this attribute. If not used, then no iteration takes place and no warning is issued. Notice that you can use <tt>#{..}</tt> only in <a href="#el">[el]</a> enabled tasks.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>in</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">expr</p></td>
<td align="left" valign="top"><p class="table">The items to be iterated over as <a href="#el">[el]</a> expression. A iteration takes place except if <tt>null</tt> is the evaluation result. Otherwise, if the evaluation result is <em>not iterable object</em>, a temporary list containg that object is created on the fly. Iteration takes then place over that list and otherwise over the iterable collection.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_elements_11">8.2.2. Elements</h4>
<div class="literalblock">
<div class="content">
<pre><tt>The body of this task may contain an arbitrary number of tasks or macros.</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_behaviour_10">8.2.3. Behaviour</h4>
<div class="paragraph"><p>This is the shortest possible for statement. It's legal albeit completely useless.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:for /&gt;</tt></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="task_break">8.3. break</h3>
<div class="paragraph"><p>A task mirroring a break statement. When used within a <a href="#tasks_for">for</a>-loop, the loop will be terminated. If this task is used outside of a <a href="#tasks_for">for</a>-loop, a build exception will be thrown.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>  &lt;c:for var="i" in=" list(1,2,3,4,5,6) "&gt;
    &lt;c:echo&gt;i = #{i}&lt;/echo&gt;
     &lt;c:when test=" i == 3 "&gt;
       &lt;c:break /&gt;
     &lt;/c:when&gt;
  &lt;/c:for&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>Being executed, the following will be dumped on stdout:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>[c:echo] i = 1
[c:echo] i = 2
[c:echo] i = 3</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_12">8.3.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="52%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table"><a href="#el">[el]</a></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>test</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table">expr</p></td>
<td align="left" valign="top"><p class="table">Terminate loop when <a href="#el">[el]</a> expression evaluates to <tt>true</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>if</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table">#{}</p></td>
<td align="left" valign="top"><p class="table">Terminate if property exists</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>unless</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table">#{}</p></td>
<td align="left" valign="top"><p class="table">Terminate if property does not exist</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_behaviour_11">8.3.2. Behaviour</h4>
<div class="paragraph"><p>When used without any attributes, the surrounding <a href="#tasks_for">for</a> or <a href="#tasks_while">while</a> loop will terminate at once. When used with attributes, then the loop will terminate if at least one attribute evaluates to <tt>true</tt>. Otherwise, the loop will not be terminated and continues as usual.</p></div>
<div class="paragraph"><p>The example given above can thus be shortened to</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>  &lt;c:for var="i" in=" list(1,2,3,4,5,6) "&gt;
    &lt;c:echo&gt;i = #{i}&lt;/echo&gt;
    &lt;c:break test=" i == 3 " /&gt;
  &lt;/c:for&gt;</tt></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="task_continue">8.4. continue</h3>
<div class="paragraph"><p>A task mirroring a continue statement. When used within a <a href="#tasks_for">for</a>-loop, the loop will be continued with the next loop item (i.e. any statements after task continue are ignored). If this task is used outside of a for-loop, a build exception will be thrown.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:for var="i" in=" list(1,2,3,4,5,6) "&gt;
   &lt;c:when test=" i &gt; 3 "&gt;
     &lt;c:continue /&gt;
   &lt;/c:when&gt;
   &lt;c:echo&gt;i = #{i}&lt;/echo&gt;
  &lt;/c:for&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>This would print:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>[c:echo] i = 1
[c:echo] i = 2
[c:echo] i = 3</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_13">8.4.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="52%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table"><a href="#el">[el]</a></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>test</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table">expr</p></td>
<td align="left" valign="top"><p class="table">Continue loop when <a href="#el">[el]</a> expression evaluates to <tt>true</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>if</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table">#{}</p></td>
<td align="left" valign="top"><p class="table">Continue if property exists</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>unless</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">-</p></td>
<td align="left" valign="top"><p class="table">#{}</p></td>
<td align="left" valign="top"><p class="table">Continue if property does not exist</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_behaviour_12">8.4.2. Behaviour</h4>
<div class="paragraph"><p>When used without any attributes, the surrounding <a href="#tasks_for">for</a> or <a href="#tasks_while">while</a> be continued while following tasks or macros are ignored in the current iteration step. When used with attributes, then the loop will be continued if at least one attribute evaluates to <tt>true</tt>. Otherwise, the subsequent tasks or macros are executed.</p></div>
<div class="paragraph"><p>The example given above can thus be shortened to</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:for var="i" in=" list(1,2,3,4,5,6) "&gt;
   &lt;c:continue test=" i &gt; 3 " /&gt;
   &lt;c:echo&gt;i = #{i}&lt;/echo&gt;
&lt;/c:for&gt;</tt></pre>
</div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part8">9. Exceptional Tasks</h2>
<div class="sectionbody">
<div class="paragraph"><p>Flaka has been charged with exception handling tasks.</p></div>
<div class="sect2">
<h3 id="task_trycatch">9.1. trycatch</h3>
<div class="paragraph"><p>A task mirroring try-catch exception handling found in modern programming languages. The following snippet demonstrates the usage of trycatch:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;c:trycatch property="reason"&gt;
   &lt;try&gt;
     &lt;echo&gt;one ..&lt;/echo&gt;
     &lt;echo&gt;two ..&lt;/echo&gt;
     &lt;fail message="bang" /&gt;
     &lt;echo&gt;three ..&lt;/echo&gt;
   &lt;/try&gt;
   &lt;catch&gt;
     &lt;echo&gt;..caught : ${reason}&lt;/echo&gt;
   &lt;/catch&gt;
   &lt;else&gt;
     &lt;echo&gt;nothing exceptionell&lt;/echo&gt;
   &lt;/else&gt;
   &lt;finally&gt;
     &lt;echo&gt;..finally&lt;/echo&gt;
   &lt;/finally&gt;
 &lt;/c:trycatch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>When executed, the following will be reported by Ant:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>[echo] one ..
[echo] two ..
[echo] ..caught : bang
[echo] ..finally</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_14">9.1.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="10%" />
<col width="25%" />
<col width="50%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>property</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">Property that should hold the exception message</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>reference</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>trycatch.object</tt></p></td>
<td align="left" valign="top"><p class="table">Reference to hold the exception object</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>catch</em>.<tt>type</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>*.BuildException</tt></p></td>
<td align="left" valign="top"><p class="table">A glob pattern to match the exception's type</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>catch</em>.<tt>match</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>*</tt></p></td>
<td align="left" valign="top"><p class="table">A glob pattern to match the exception's message</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_elements_12">9.1.2. Elements</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="85%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Element</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">try</p></td>
<td align="left" valign="top"><p class="table">A task container to hold tasks and macros to be given a try</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">catch</p></td>
<td align="left" valign="top"><p class="table">A task container to be executed if an exception gets thrown</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">else</p></td>
<td align="left" valign="top"><p class="table">Task container executed if no exception is thrown in the <tt>try</tt> element</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">finally</p></td>
<td align="left" valign="top"><p class="table">A task container to be executed in any case</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>All elements are optional. There can be an arbitrary number of catch-clauses.</p></div>
</div>
<div class="sect3">
<h4 id="_behaviour_13">9.1.3. Behaviour</h4>
<div class="paragraph"><p>If a try-clause exists, then tasks within that clause are executed. If an exception is thrown by one of them, then ..</p></div>
<div class="ulist"><ul>
<li>
<p>
If a property name is given, then that property will hold the message of the exception thrown.
</p>
</li>
<li>
<p>
If a reference name is given, then that reference will hold the exception object thrown.
</p>
</li>
<li>
<p>
All catch-clauses are tried in syntactical order whether a clause matches.
</p>
</li>
<li>
<p>
If there is a <em>matching</em> catch clause, then all tasks in that matching clause are executed and all further catch-clauses are ignored.
</p>
</li>
</ul></div>
<div class="paragraph"><p>If no exception is thrown within the try-clause, then an optional else-clause will be executed.</p></div>
<div class="paragraph"><p>An optional finally-clause is always executed, regardless of whether an exception gets thrown in a try-, else- or within a catch-clause. A finally-clause is especially executed in the absence of a try-clause.</p></div>
<div class="paragraph"><p>An exception thrown in a try-clause for which a matching catch-clause exists, is assumed to be handled by the matching clause and therefore not propagated. An exception for which no matching clause exists, an exception thrown in an else-clause or in a matching catch-clause is propagated to an optional existing finally-clause. If no finally-clause exists, then the incoming exception will be propagated to the caller. The finally-clause propagates it's incoming exception to the caller.</p></div>
<div class="paragraph"><p>An exception thrown in a catch-clause, in an else-clause or in a finally-clause overrides any previously existing exception when propagating. However, an exception thrown in a catch-, else- or finally-clause will neither update nor assign the property or reference.</p></div>
<div class="paragraph"><p>A catch-clause can be decorated with a <em>type</em> or <em>match</em> argument to handle a specific exception class. Both arguments expect a glob expression. A catch-clauses matches if both, the type-argument and the match-argument do match. The type-argument is matched against exception's native type name. The match-argument is matched against the exception's message. Both default values ensure that a build exception thrown by Ant is caught while an implementation dependent exception passes. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:trycatch&gt;
   &lt;try&gt;
      &lt;fail message="houston, we have a problem" /&gt;
   &lt;/try&gt;
   &lt;catch match="*houston*"&gt;
     ; handle exceptions where the exception's message
     ; contains the word 'houston'
   &lt;/catch&gt;
   &lt;catch type="java.lang.*"&gt;
     ; handle Java runtime exceptions
   &lt;/catch&gt;
   &lt;catch&gt;
     ; handle standard build exceptions
   &lt;/catch&gt;
&lt;/c:trycatch&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>When matching against the error message, be aware that the actual error message might be slightly different from the actual message given cause usually the error message contains also information about where the exception got thrown. It is therefore wise to accept any leading and trailing space.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="task_throw">9.2. throw</h3>
<div class="paragraph"><p>A task to re-throw a previously thrown exception.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:trycatch&gt;
  &lt;try&gt;
     &lt;fail message="houston,.."/&gt;
  &lt;/try&gt;
  &lt;catch&gt;
    &lt;echo level="DEBUG"&gt;*** exception seen ***&lt;/echo&gt;
    &lt;c:throw /&gt;
  &lt;/c:catch&gt;
&lt;/c:trycatch&gt;</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_15">9.2.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="15%" />
<col width="20%" />
<col width="50%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>reference</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>trycatch.object</tt></p></td>
<td align="left" valign="top"><p class="table">The name of the reference holding the previously thrown exception</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>var</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>trycatch.object</tt></p></td>
<td align="left" valign="top"><p class="table">An alias for attribute <tt>reference</tt></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_behaviour_14">9.2.2. Behaviour</h4>
<div class="paragraph"><p>When this task is executed, it looks-up whether the current project contains a specific reference. By default, the name of that reference is <tt>trycatch.object</tt>. The name of this reference can be changed  by using attribute <tt>reference</tt>. If that reference exists and an exception is attached with that reference, then that exception is thrown. Otherwise, a standard build exception is generated and thrown. In that case, <tt>throw</tt> acts like Ant's standard task <tt>fail</tt>.</p></div>
<div class="paragraph"><p>Note that <tt>throw</tt> works in any context. Consider</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:trycatch&gt;
 &lt;try&gt;
   &lt;fail message="houston,.." /&gt;
 &lt;/try&gt;
 ; ignores build exception
 &lt;catch /&gt;
&lt;/c:trycatch&gt;
..
; very much later
..
; throws build exception 'houston,..'
&lt;c:throw /&gt;</tt></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="task_fail">9.3. fail</h3>
<div class="paragraph"><p>This task has been derived from Ant's core task <tt>fail</tt> <span class="footnote"><br />[see <a href="http://ant.apache.org/manual/CoreTasks/fail.htm">http://ant.apache.org/manual/CoreTasks/fail.htm</a>]<br /></span>. In addition, EL-references can be used regardless whether <a href="#el">[el]</a> has been enabled or not. Furthermore, attribute <tt>test</tt> has been added. The value of <tt>test</tt> will be evaluated as EL expression in a boolean context. Thus it is possible to throw a build exception not only based on whether a property exists or not but also whether an EL-expression is evaluated as <tt>true</tt>.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:fail message="negative number #{ i } seen" test=" i lt 0 " /&gt;</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_16">9.3.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="15%" />
<col width="70%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attribute</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>test</tt></p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table">An arbitrary EL-expression.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part9">10. Other Tasks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="task_install_property_handler">10.1. install-property-handler</h3>
<div class="paragraph"><p>A task to install Flaka's property handler. When installed, Ant <em>understands</em>  <a href="#el">[el]</a> references like <tt>#{..}</tt> in addition to standard property references <tt>${..}</tt>. Consider:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> &lt;echo&gt;
    #{3 * 4}
 &lt;/echo&gt;
 &lt;c:install-property-handler /&gt;
 &lt;echo&gt;
    #{3 * 4}
 &lt;/echo&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>This is the output of above's snippet:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt> [echo] [1] #{3 * 4}
 [echo] [2] 12</tt></pre>
</div></div>
<div class="sect3">
<h4 id="_attributes_17">10.1.1. Attributes</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Attributes</p></td>
<td align="left" valign="top"><p class="table">Type</p></td>
<td align="left" valign="top"><p class="table">Default</p></td>
<td align="left" valign="top"><p class="table">EL</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">type</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"><tt>elonly</tt></p></td>
<td align="left" valign="top"><p class="table">#{}</p></td>
<td align="left" valign="top"><p class="table">Install handler with certain additional features  enabled (see below)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_behaviour_15">10.1.2. Behaviour</h4>
<div class="paragraph"><p>If <tt>type</tt> is <tt>elonly</tt> (exactly as written), then the new handler will only handle <tt>#{..}</tt> in addition. If <tt>type</tt> is <tt>remove</tt>, then unresolved property references are discarded.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="task_rescue">10.2. rescue</h3>
<div class="paragraph"><p>Task <tt>rescue</tt> is essentially a container for an arbitrary number of tasks. In addition, it allows to rescue variables and properties.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;c:rescue&gt;
 &lt;vars&gt;
   foo
 &lt;/vars&gt;
 &lt;properties&gt;
   bar
 &lt;/properties&gt;
 task_1
   ..
 task_N
&lt;c:rescue&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>No matter what will happen with property <tt>var</tt> and variable <tt>foo</tt> within <tt>sequential</tt>, this will be unoticable outside of <tt>rescue</tt> cause the values (or better: state) will be restored after having executed all embedded tasks. This will of course also work in case an exception is thrown by one of the tasks.</p></div>
<div class="sect3">
<h4 id="_attributes_18">10.2.1. Attributes</h4>
<div class="paragraph"><p>This task does not define attributes.</p></div>
</div>
<div class="sect3">
<h4 id="_elements_13">10.2.2. Elements</h4>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="15%" />
<col width="35%" />
<col width="50%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Name</p></td>
<td align="left" valign="top"><p class="table">Cardinality</p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>vars</tt></p></td>
<td align="left" valign="top"><p class="table">0..1</p></td>
<td align="left" valign="top"><p class="table">Defines a <a href="#task_list">[task_list]</a> of variable names. Attributes and behaviour is that of task <a href="#task_list">[task_list]</a> except that interpretation of lines as <a href="#el">[el]</a> expressions are disabled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>properties</tt></p></td>
<td align="left" valign="top"><p class="table">0..1</p></td>
<td align="left" valign="top"><p class="table">Defines a <a href="#task_list">[task_list]</a> of property names. Attributes and behaviour is that of task <a href="#task_list">[task_list]</a> except that interpretation of lines as <a href="#el">[el]</a> expressions are disabled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>task</em></p></td>
<td align="left" valign="top"><p class="table">arbitrary</p></td>
<td align="left" valign="top"><p class="table">A (arbitrary) task or macro to be excecuted</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_behaviour_16">10.2.3. Behaviour</h4>
<div class="paragraph"><p>Executes all embedded tasks. Variables and properties listed in <tt>vars</tt> and <tt>properties</tt> are restored to their previous state, i.e. if not existing before the execution, they will not exist afterwards. If existed, their value will be restored.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="glossary">11. Flaka Glossary</h2>
<div class="sectionbody">
<div class="paragraph"><p>A compilation of words and their meaning in Flaka.</p></div>
<div class="sect2">
<h3 id="glossary_continuation_lines">11.1. Whitespace</h3>
<div class="paragraph"><p>Whitespace characters are the blank character (<em>SP</em>,` <tt>), the horizontal tab character (_HT_,</tt>\t`) and the form feed character (<em>FF</em>,<tt>\f</tt>). End-of-line characters are not considered whitespace in this document.</p></div>
</div>
<div class="sect2">
<h3 id="_end_of_line">11.2. End-of-Line</h3>
<div class="paragraph"><p>A line-ending character sequence is either a carriage-return character followed by a line-feed character or the single line-feed character.</p></div>
</div>
<div class="sect2">
<h3 id="_continuation_lines">11.3. Continuation Lines</h3>
<div class="paragraph"><p>A continuation line is a sequence of characters with a non-escaped backslash character as last character before the end-of-line sequence. Tasks supporting continuation lines will accumulate the content of such a line with the <em>accumulated</em> content of the following physical line. The continuation character, the line-ending character sequence and all immediate whitespace characters are not accumulated.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>a\
 b\\\
c</tt></pre>
</div></div>
<div class="paragraph"><p>Defines two logical lines: (1) <tt>a b\\</tt> and (2) <tt>c</tt>.</p></div>
</div>
<div class="sect2">
<h3 id="_comment_lines">11.4. Comment Lines</h3>
<div class="paragraph"><p>A comment line is a sequence of character where the first non-whitespace character is the comment character - usually the character <em>;</em>:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>    ; a comment line
 no ; comment line
   \; not a comment line</tt></pre>
</div></div>
<div class="paragraph"><p>Here, only the first line defines a comment line. The second line contains an inline-comment. When processed, comment-line get entirely removed from input up and including the end-of-line character sequence. In case a line must start with the comment-line character, then sequence <tt>\;</tt> can be used to do so. It must be noted, that escape character <tt>\</tt> has no other meaning, i.e. <tt>\\</tt> will not produce single character <tt>\</tt> but rather <tt>\\</tt>.</p></div>
</div>
<div class="sect2">
<h3 id="_inline_comments">11.5. Inline Comments</h3>
<div class="paragraph"><p>A inline-comment is a sequence of characters starting with the inline-comment character and ending - while not including - the end-of-line sequence or end of input. Inline comments are discarded when processed. In case character <tt>;</tt> shall keep it's usual meaning, then <tt>\;</tt> can be used to do so.</p></div>
</div>
<div class="sect2">
<h3 id="glossary_property_reference">11.6. Property Reference</h3>
<div class="paragraph"><p>A reference to a <a href="http://ant.apache.org/manual/using.html#properties">property</a> is written as <tt>${..}</tt>. Property references are handled by the Ant property handler. If not changed, then <tt>${x}</tt> will be replaced by the value of property <tt>x</tt> if such a property exists. Otherwise, the reference will be left as is.</p></div>
</div>
<div class="sect2">
<h3 id="glossary_expression_reference">11.7. Expression Reference</h3>
<div class="paragraph"><p>A reference to an <a href="#el">[el]</a> expression is written as <tt>#{..}</tt>. <a href="#el">[el]</a> is not part of Ant and can thus only be handled by certain tasks. References may appear in attribute values or in text elements. Not all attributes can handled EL references and neither all text elements. If a attribute or text element can handle EL references, it is specifically mentioned.</p></div>
</div>
<div class="sect2">
<h3 id="glossary_base_folder">11.8. Base Folder</h3>
<div class="paragraph"><p>Relative files are usually meant to be relative to the current working directory. Not so in Ant, where a file is relative to the folder containing the build script of the current project. This folder is called the base directory or base folder. Ant defines property &#8216;basedir` to contain the (absolute) path name of this folder. When using <a href="#el">[el]</a> expressions you can use the empty string to create the base folder as file object, like in ` '&#8217;.tofile `.</p></div>
<div class="paragraph"><p>See also <a href="http://ant.apache.org/manual/using.html#built-in-props">built-in-props</a> for a list of standard Ant properties.</p></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Version 1.1<br />
Last updated 2010-11-30 11:08:12 CET
</div>
</div>
</body>
</html>
